@model Entities.HolidayList
@{
    var rolepages = TempData["RolePages"].ToString();
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.RolePages = TempData["RolePages"];
}
<div class="container">
    <div class="panel with-nav-tabs panel-primary">
        <div class="panel-heading">
           @{
            <ul class="nav nav-tabs">
                @if (rolepages.Contains("MABAN"))
                {
                    <li><a href="@Url.Action("Create", "Banks")" data-toggle="tab" id="1">Bank</a></li>}
                @if (rolepages.Contains("MABRA"))
                {
                    <li><a href=@Url.Action("Create", "Branches")>Branch</a></li>}

                @if (rolepages.Contains("MADEP"))
                {
                    <li><a href=@Url.Action("Create", "Departments")>Department</a></li>}
                @if (rolepages.Contains("MADES"))
                {
                    <li><a href=@Url.Action("Create", "Designations")>Designation</a></li>}
                @if (rolepages.Contains("MAROL"))
                {
                    <li><a href=@Url.Action("Create", "Roles")>Role</a></li>}
                @if (rolepages.Contains("MALTY"))
                {
                    <li><a href=@Url.Action("Create", "LeaveTypes")>LeaveType</a></li>}
                @if (rolepages.Contains("MAHLI"))
                {
                    <li class="active"><a href=@Url.Action("Create", "HolidayLists")>HolidayList</a></li>}
                @if (rolepages.Contains("MACDL"))
                {
                    <li><a href=@Url.Action("CreditDebitleaves", "MyLeaves")>Credit / Debit leaves</a></li>}
                @if (rolepages.Contains("MABCY"))
                {
                    <li><a href=@Url.Action("Createbranchcount", "Branches")>Branch Category</a></li>}
                @if (rolepages.Contains("MAODY"))
                {
                    <li><a href=@Url.Action("OtherdutyCreate", "LeaveTypes")>Other Duty</a></li>}
                @if (rolepages.Contains("MABPD"))
                {
                    <li><a href=@Url.Action("Create", "BlockPeriod")>BlockPeriod</a></li>}
                @if (rolepages.Contains("MANES"))
                {
                    <li><a href=@Url.Action("Create", "News")>News</a></li>}
            </ul>
        }      
        </div>
    </div>
</div>

@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()
    <div class="container">
        <div class="page_st">
            <div class="page col-md-12 col-sm-12">
                <div class="main_heading">
                    <h1>Edit Holiday List</h1>
                    <div class="form-horizontal col-md-offset-3 col-md-6 col-sm-6">
                        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                        @Html.HiddenFor(model => model.Id)
                        <div class="col-md-12">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">Occasion:<span class="mandatory">*</span></label>
                                <div class="col-sm-8">
                                    @Html.TextBoxFor(model => model.Occasion, new { @class = "form-control", @id = "Occas" })
                                    @Html.ValidationMessageFor(model => model.Occasion, "", new { @class = "text-danger" })
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">Date:<span class="mandatory">*</span></label>
                                <div class="col-sm-8">
                                    <div class="input-group date" id="Date">
                                        @{ Html.EnableClientValidation(false); }
                                        @Html.TextBoxFor(m => m.Date, new { @class = "form-control", @id = "dat", @Value = @TempData["WantedDate"] , onkeypress = "return nokeyword(event)" })<span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
                                        @Html.ValidationMessageFor(model => model.Date, "", new { @class = "text-danger" })
                                        @{ Html.EnableClientValidation(true); }
                                    </div>
                                </div>
                            </div>
                            </div>
                            <div class="col-md-12">
                                <div class="pull-right">
                                    <button type="reset" class="btn btn-default">Cancel</button>
                                    <input type="submit" value="Update" onclick="return holiedit();" class="btn btn-primary" />
                                </div>
                            </div>
                        </div>
                </div>
            </div>
        </div>
    </div>
                                        }
@{

    var message = TempData["AlertMessage"] ?? string.Empty;

}
<script type="text/javascript">
    var message = '@message';

    if (message) alert(message);

</script>

<script>
    document.getElementById("a2").className = "active";

</script>


<style>
    .activeClass {
        background: #ffdb99;
    }

    .secondClass {
        /*background: #FF9999;*/
        color: red;
    }
</style>

<script type='text/javascript'>
    $(function getholidays() {
        var active_dates = [];
    $.ajax({
        type: "GET",
        async: false,
        url: "/LeaveApply/GetDates",
        dataType: "Json",
        success: function (data) {
            datesArray = data;
            for (i = 0; i < datesArray.length; i++) {
                var result = datesArray[i].replace("-", "/");
                var result1 = result.replace("-", "/");
                var strArray = result1.split("/");
                var cdate = strArray[0] + "/" + parseInt(strArray[1]) + "/" + strArray[2]
                active_dates.push(cdate);

                if(i==datesArray.length-1)
                {
                    //loadcal(active_dates);
                }
            }

        }
    });
    $('#Date').datepicker({
        format: "dd/mm/yyyy",
        autoclose: true,
        todayHighlight: true,
        beforeShowDay: function nonWorkingDays(date) {
            var day = date.getDay(), Sunday = 0, Monday = 1, Tuesday = 2, Wednesday = 3, Thursday = 4, Friday = 5, Saturday = 6;
            var week = 0 | date.getDate() / 7 //get the week
            var dd = date.getDate();
            var month = date.getMonth();
            if (dd < 10) {
                dd = '0' + dd
            }

            if (month < 10) {
                month = '0' + month
            }
            var sunweek = date.getDay();
            var year = date.getFullYear();

            if (dd == 14 && day == 6) {
                return {
                    classes: 'secondClass'
                };
            }
            if (dd == 28 && day == 6) {
                return {
                    classes: 'secondClass'
                };
            }
                //check if it's second week or fourth week
            else if (week == 1 || week == 3) {
                if (dd == 7 && day == 6 || dd == 21 && day == 6) {
                    //check for satruday                 

                }
                else {
                    if (day == 6) {
                        return {
                            classes: 'secondClass'
                        };
                    }
                }

            }
            //check for sunday
            if (day == 0) {
                return {
                    classes: 'secondClass'
                };

            }
            //check for holidays
            var d = date;
            var curr_date = d.getDate();
            var curr_month = d.getMonth() + 1; //Months are zero based
            if (curr_date < 10) {
                curr_date = '0' + curr_date
            }
            var curr_year = d.getFullYear();
            var formattedDate = curr_date + "/" + curr_month + "/" + curr_year

            if ($.inArray(formattedDate, active_dates) != -1) {
                return {
                    classes: 'activeClass'
                };
            }
            return [true];
        }
    });
  });
</script>