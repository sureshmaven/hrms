<style>
    #menuheader {
        display: none;
    }

    .footer {
        display: none;
    }

    .page_st {
        background: none;
    }

    .page {
        padding-top: 54px;
    }

    p {
        font-size: 18px;
        line-height: 30px;
        color: #000;
        text-align: justify;
    }

    .container {
        width: 98%;
    }

    span {
        font-size: 18px;
        margin-bottom: 29px;
    }

    td {
        font-size: 18px;
    }

    li {
        font-size: 18px;
        color: #000;
    }

    .pdf_data {
        margin-bottom: 72px;
        width: 90%;
        margin: 0 auto;
    }

    #cmd {
        width: auto;
        margin-right: 5%;
        margin-bottom: 10px;
        float: right;
        margin-top: 14px;
    }
    /*new added by Raju on 25/3/2022*/
    #cmdword {
        width: auto;
        margin-right: 5%;
        margin-bottom: 10px;
        float: right;
        margin-top: 14px;
    }

    #latememoword {
        display: none;
    }
    /*end*/

    .table td {
        border: 1px solid #000 !important;
    }
</style>
@*<style type="text/css">
        @Page word_data{size: 204.45pt 50.21pt;mso-page-orientation: portrait;}
        div.word_data {page: word_data;}
    </style>*@
@* this div placed outside the main div by chaitanya on 8/5/2020 *@
<div class="col-md-12 col-sm-12">
    <div id="display">
        <button id="cmd" class="btn btn-info">Print PDF</button>
    </div>
    <div id="displayword">
        <button id="cmdword" class="btn btn-info" onclick="Export2Doc('latememoword');">Print Word</button>
    </div>
</div>
@* end *@
<div id="content">
    <div class="col-md-12 col-sm-12 ">

        <div class="clearfix"></div>
        <div class="pdf_data" style="margin-bottom: 72px;">
            <div style="margin: 0 auto;border: 1px solid #000;background: #fff;padding: 71px;">
                <table class="table">
                    <tr>
                        <td rowspan="2">
                            @* Changed below image to logo_pdf.jpg to logo.png (becoz logo_pdf.jpg is not loading in the server)*@
                            <img src="~/Assets/images/logo.png" style="width: 70%; margin-top: 27px;">
                        <td>
                            <p style="font-size:30px; text-align: right; line-height: 36px;">Telangana State Co-operative<br><strong>Apex</strong> Bank Limited</p>
                            <p style="font-size:13px; text-align: right;">(State Govt. Partnered Scheduled Bank)</p>
                            <p style="text-align: right;">Troop Bazar, Hyderabad-500 001</p>
                        </td>
                    </tr>
                    <tr>
                        <td><p style="text-align: right;">HRD Department :: Ph: 24685526/559 :: url: https://tscab.org </p></td>
                    </tr>
                </table>
                <span><strong>Ref:</strong> TSCAB/HRD/LEAVES/2022 </span>
                <span style="float:right;">Date:@ViewBag.IssueDate.ToShortDateString()</span>
                <p style="font-size:20px; text-align:center;margin: 0 0 0 150px;"><strong>MEMORANDUM <span style="position: absolute; margin: 0 0 0 -156px;">_____________________</span></strong></p><br />
                <p style="text-align:center;">
                    <strong>Sub:</strong>
                    HRD(Leaves)– Late Attendance- Debit of leave account- Explanation called for- Reg.

                </p>
                <br />
                <p style="text-align:center;">***</p><br />
                <p>As per Biometric record, it is observed that, the following employee has attended late to the Bank on the dates indicated against his/her name during the month of <u>(@ViewBag.IssueDate.ToShortDateString())</u></p>
                <br />
                <table class="table" bgcolor="#3c3c3c" style="width:100%">
                    <tr bgcolor="#ffffff">
                        <td>Code</td>
                        <td>Emp Name</td>
                        <td>Designation</td>
                        <td>Branch/Dept</td>
                        <td>MemoType</td>
                        <td>Memo Details</td>
                        <td>Noofdays</td>
                        @*<td>Clarification</td>*@
                    </tr>
                    <tr bgcolor="#f fffff">
                        <td style="text-align:left;">@ViewBag.EmpCode</td>
                        <td style="text-align:left;">@ViewBag.EmpName</td>
                        <td style="text-align:left;">@ViewBag.Designation</td>
                        <td style="text-align:left;">@ViewBag.branchname</td>
                        <td style="text-align:left;">@ViewBag.MemoType</td>
                        <td style="text-align:left;">@ViewBag.Memodetails</td>
                        <td style="text-align:center;">@ViewBag.Noofdays</td>
                        @*<td style="text-align:left;">@ViewBag.Clarification</td>*@
                    </tr>
                </table><br />
                <p>It may be noted that as per SSR No. 49(iii): "An employee who is habitually late in attendance, shall in addition to such other penalty as the disciplinary authority may deem fit to impose, have <strong>one day of</strong> casual leave forfeited for <strong>every three days</strong> he/she is late in any calendar month. Where such an employee has no casual leave due to him/her, the period of leave to be so forfeited may be treated as ordinary or extra-ordinary leave as the competent authority may determine."</p><br />
                <p>Accordingly, the above employee will be forfeiting (  @*&nbsp;  &nbsp;  &nbsp; &nbsp;*@ @ViewBag.Noofdays  ) days CL/PL/LOP, for late attendance. He/she is called upon to explain as to why the said leave should not be debited from his/her leave account for the above reason.</p><br>
                <p>His/Her explanation should reach the undersigned within three days from the date of receipt of this Memorandum.</p>
                <br />
                <br /><br />
                <p style="float:right; font-size:20px; font-weight:bold;">Dy General Manager (HRD)</p>
                <br />
                <br />
                <br />
                <br />
                <p>To,</p>
                <ul>
                    @*<li style="list-style:none;">&#10003; Copy to the Dy General Manager (&nbsp; &nbsp;  &nbsp;&nbsp; &nbsp;  &nbsp;  &nbsp;  &nbsp; &nbsp;  &nbsp;  &nbsp;  &nbsp; &nbsp; &nbsp;  &nbsp;  &nbsp; &nbsp; &nbsp;  &nbsp;  &nbsp; &nbsp;               ).</li>*@
                    <li style="list-style:none;">@ViewBag.EmpName,</li>
                    <li style="list-style:none">@ViewBag.Designation</li>
                    <li style="list-style:none">@ViewBag.EmpCode</li>
                    @*<li style="list-style:none;">&#10003; Copy submitted to EA to Managing Director.</li>*@
                </ul><br /><br />
                <br /><br /><br /><br /><br /><br /><br /><br /><br />

            </div>
        </div>

    </div>

</div>

<div class="word_data" style="margin-bottom: 25px;" id="latememoword">
    @*<div class="word_data1" style="margin: 0 auto;border: 1px solid #000;background: #fff;padding: 21px;">*@

    <table class="table" id="tableword" border="1" cellspacing="0" cellpadding="0" colspan="10" align="center" style="font-family:HELVETICA;width:692px;height:1000px">
        <tr>
            <td rowspan="2" colspan="3">
                <img src="~/Assets/images/logo.png" style="width: 20%;height:20%; margin-top: 5px;margin-bottom:5px;margin-left:5px;margin-right:5px">
            </td>
            <td colspan="7">
                <p style="font-size:32px; text-align: right; line-height: 27px; margin-right:10px;">Telangana State Co-operative <br><strong>Apex </strong>Bank Limited</p>
                <p style="font-size:14px; text-align: right; margin-right:10px">(State Govt. Partnered Scheduled Bank)</p>
                <p style="font-size:15px;text-align: right; margin-right:10px">Troop Bazar, Hyderabad-500 001</p>
            </td>
        </tr>
        <tr>
            <td colspan="7"><p style="text-align: right; margin-right:10px;font-size:14px">HRD Department :: Ph: 24685526/559 :: url: https://tscab.org </p></td>
        </tr>
        @*<tr>
                <td colspan="10" style="border-bottom:none;border-top:none">&nbsp;</td>
            </tr>*@
        @*</table>*@
        @*<p style="font-size:40px; text-align: center; line-height: 36px;">Telangana State Co-operative Apex Bank Limited</p>
            <p style="font-size:13px; text-align: center">(State Govt. Partnered Scheduled Bank)</p>
            <p align="right">Troop Bazar, Hyderabad-500 001</p>

            <p style="text-align: right;">HRD Department :: Ph: 24685526/559 :: url: https://tscab.org </p>*@

        @*<span><strong>Ref:</strong> TSCAB/HRD/F.No.CF/BA/1</span>
            <span align="right">Date:@ViewBag.Date</span>*@
        @*<p style="text-align:left"><strong>Ref:</strong>TSCAB/HRD/F.No.CF/BA/1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Date:@ViewBag.Date</p>*@
        @*<p style="text-align:left"><strong>Ref:</strong>TSCAB/HRD/F.No.CF/BA/1 <span style="float:right">Date:@ViewBag.Date</span></p>*@
        @*<span style="float:left"><strong>Ref:</strong>TSCAB/HRD/F.No.CF/BA/1</span>
            <span style="float:right"> Date:@ViewBag.Date</span>*@
        @*<br>*@
        @*<table id="tbl_date" style="width:100%;border-collapse: collapse;" colspan="10">*@
        <tr>
            <td style=" border-right:none;border-bottom:none; font-size:14px;margin-left:5px;" colspan="6"><p><strong>Ref:</strong>TSCAB/HRD/LEAVES/2022</p></td>
            <td style=" border-left:none;border-bottom:none; font-size:14px;margin-right:5px;" colspan="4"><p style="text-align:right;"><strong>Date:</strong>@ViewBag.Date</p></td>
        </tr>
        @*<tr>
                <td colspan="10" style="border-top:none;border-bottom:none">&nbsp;</td>
            </tr>*@
        @*</table>*@

        @*<p style="text-align: left; width:49%; display: inline-block;"><strong>Ref:</strong>TSCAB/HRD/F.No.CF/BA/1</p>*@
        @*<p style="text-align: right; width:50%;  display: inline-block;">Date:@ViewBag.Date</p>*@
        @*<table colspan="10" align="center">*@
        <tr>
            <td colspan="10" style="border-top:none;border-bottom:none">
                <p style="text-align:center;font-size:14px;"><strong><u>MEMORANDUM</u></strong></p>
                @*<p style="font-size:20px; text-align:center;margin: 0 0 0 150px;"><b><u>MEMORANDUM <span style="position: absolute; margin: 0 0 0 -156px;"></span></u></b></p>*@
            </td>
        </tr>
        <tr>
            <td colspan="10" style="border-top:none;border-bottom:none">&nbsp;</td>
        </tr>
        <tr>
            <td colspan="10" style="border-top:none;border-bottom:none">
                <p style="text-align:center;font-size:14px;">
                    <strong>Sub:</strong> HRD(Leaves)– Late Attendance- Debit of leave account- Explanation called for- Reg.
                </p>
            </td>
        </tr>
        <tr>
            <td colspan="10" style="border-top:none;border-bottom:none;">&nbsp;</td>
        </tr>
        <tr>
            <td colspan="10" style="border-top:none;border-bottom:none">
                <p style="text-align:center;font-size:14px;">***</p>
            </td>
        </tr>
        @*<tr>
                <td colspan="10" style="border-top:none;border-bottom:none;font-size:14px;">&nbsp;</td>
            </tr>*@
        <tr>
            <td colspan="10" style="border-top:none;border-bottom:none">
                <p style="font-size:14px;margin-left:5px;">As per Biometric record, it is observed that, the following employee has attended late to the Bank on the dates indicated against his/her name during the month of <strong><u>(@ViewBag.IssueDate.ToShortDateString())</u></strong></p>
            </td>
        </tr>
        <tr>
            <td colspan="10" style="border-top:none;border-bottom:none">&nbsp;</td>
        </tr>
        @*</table>*@
        @*<p style="font-size:20px; text-align:center;margin: 0 0 0 150px;"><b><u>MEMORANDUM <span style="position: absolute; margin: 0 0 0 -156px;"></span></u></b></p><br />*@
        @*<p style="text-align:center;"><strong>Sub:</strong> HRD Dept. – Late Attendance - Debit of leave account – Explanation called for – Reg.</p>*@
        @*<br />*@
        @*<p style="text-align:center;">***</p><br />*@
        @*<p>As per Biometric record, it is observed that, the following employee has attended late to the Bank on the dates indicated against his/her name during the month of <u>(@ViewBag.MonthName)</u></p>*@
        @*<br />*@
        @*<table class="table" bgcolor="#3c3c3c" colspan="10" align="center">*@
        <tr bgcolor="#ffffff">
            <td style="text-align:left;font-size:14px;margin-left:5px;" colspan="1"><strong>Code</strong></td>
            <td style="text-align:left;font-size:14px;" colspan="1"><strong>Emp Name</strong></td>
            <td style="text-align:left;font-size:14px;" colspan="1"><strong>Designation</strong></td>
            <td style="text-align:left;font-size:14px;" colspan="1"><strong>Branch/Dept</strong></td>
            <td style="text-align:left;font-size:14px;" colspan="1"><strong> MemoType</strong></td>
            <td style="text-align:left;font-size:14px;" colspan="1"><strong> Memo Details</strong></td>
            <td style="text-align:left;font-size:14px;" colspan="1"><strong>No.of days Late</strong></td>
            @*<td style="text-align:left;font-size:14px;" colspan="2"><strong> Clarification</strong></td>*@
        </tr>
        <tr bgcolor="#f fffff">
            <td style="text-align:left;font-size:14px;margin-left:5px;" colspan="1">@ViewBag.EmpCode</td>
            <td style="text-align:left;font-size:14px;" colspan="1">@ViewBag.EmpName</td>
            <td style="text-align:left;font-size:14px;" colspan="1">@ViewBag.Designation</td>
            <td style="text-align:left;font-size:14px;" colspan="1">@ViewBag.branchname</td>
            <td style="text-align:left;font-size:14px;" colspan="1">@ViewBag.MemoType</td>
            <td style="text-align:left;font-size:14px;" colspan="1"> @ViewBag.Memodetails</td>
            <td style="text-align:left;font-size:14px;" colspan="1">@ViewBag.Noofdays</td>
            @*<td style="text-align:left;font-size:14px;" colspan="2">@ViewBag.Clarification</td>*@
        </tr>
        <tr>
            <td colspan="10" style="border-bottom:none">&nbsp;</td>
        </tr>

        @*</table>*@
        @*<br />*@
        @*<table colspan="10" align="center">*@
        <tr>
            <td colspan="10" style="border-bottom:none;border-top:none;">
                <p style="text-align:left;font-size:14px;margin-left:5px;">It may be noted that as per SSR No. 49(iii): "An employee who is habitually late in attendance, shall in addition to such other penalty as the disciplinary authority may deem fit to impose, have one day of casual leave forfeited for every three days he/she is late in any calendar month. Where such an employee has no casual leave due to him/her, the period of leave to be so forfeited may be treated as ordinary or extra-ordinary leave as the competent authority may determine."</p>
            </td>
        </tr>
        <tr>
            <td colspan="10" style="border-top:none;border-bottom:none">&nbsp;</td>
        </tr>
        <tr>
            <td colspan="10" style="border-top:none;border-bottom:none;font-size:14px;">
                <p style="font-size:14px;margin-left:5px;">Accordingly, the above employee will be forfeiting (  &nbsp;  &nbsp;  &nbsp; &nbsp;  ) days CL/PL/LOP, for late attendance. He/she is called upon to explain as to why the said leave should not be debited from his/her leave account for the above reason.</p>
            </td>
        </tr>
        <tr>
            <td colspan="10" style="border-top:none;border-bottom:none">&nbsp;</td>
        </tr>
        <tr>
            <td colspan="10" style="border-top:none;border-bottom:none;font-size:14px;">
                <p style="margin-left:5px;font-size:14px;">His/Her explanation should reach the undersigned within three days from the date of receipt of this Memorandum.</p>
            </td>
        </tr>
        @*<tr>
                <td colspan="10" style="border-top:none;border-bottom:none">&nbsp;</td>
            </tr>*@
        <tr>
            <td colspan="10" style="border-top:none;border-bottom:none;font-size:16px;">
                <p style="text-align:right; font-size:16px; font-weight:bold;margin-right:7px;">Dy General Manager (HRD)</p>
            </td>
        </tr>
        @*<tr>
                <td colspan="10" style="border-top:none;border-bottom:none">&nbsp;</td>
            </tr>
            <tr>
                <td colspan="10" style="border-top:none;border-bottom:none">&nbsp;</td>
            </tr>
            <tr>
                <td colspan="10" style="border-top:none;border-bottom:none">&nbsp;</td>
            </tr>
            <tr>
                <td colspan="10" style="border-top:none;border-bottom:none">&nbsp;</td>
            </tr>*@
        @*<tr>
                <td colspan="10" style="border-top:none;border-bottom:none">&nbsp;</td>
            </tr>*@

        <tr>
            <td colspan="10" style="border-top:none;border-bottom:none;font-size:12px;">
                <p font-size:13px;>To,</p>
            </td>
        </tr>
        <tr>
            <td colspan="10" style="border-top:none;border-bottom:none;font-size:7px;">&nbsp;</td>
        </tr>
        <tr>
            <td colspan="10" style="border-top:none;">
                @*<li style="list-style:none;font-size:12px;">&#10003; Copy to the Dy General Manager (&nbsp; &nbsp;  &nbsp;&nbsp; &nbsp;  &nbsp;  &nbsp;  &nbsp; &nbsp;  &nbsp;  &nbsp;  &nbsp; &nbsp; &nbsp;  &nbsp;  &nbsp; &nbsp; &nbsp;  &nbsp;  &nbsp; &nbsp;               ).</li>*@
                <p style="font-size:13px;">@ViewBag.EmpName,<br>@ViewBag.Designation ,<br>@ViewBag.EmpCode</p>
                @*<li style="list-style:none;font-size:12px;">&#10003; Copy submitted to EA to Managing Director.</li>*@
            </td>
        </tr>
        <tr>
            <td colspan="10" style="border-top:none;border-bottom:none;font-size:7px;">&nbsp;</td>
        </tr>
    </table>
    @*<p>It may be noted that as per SSR No. 49(iii): "An employee who is habitually late in attendance, shall in addition to such other penalty as the disciplinary authority may deem fit to impose, have <strong>one day of</strong> casual leave forfeited for <strong>every three days</strong> he/she is late in any calendar month. Where such an employee has no casual leave due to him/her, the period of leave to be so forfeited may be treated as ordinary or extra-ordinary leave as the competent authority may determine."</p><br />
        <p>Accordingly, the above employee will be forfeiting (  &nbsp;  &nbsp;  &nbsp; &nbsp;  ) days CL/PL/LOP, for late attendance. He/she is called upon to explain as to why the said leave should not be debited from his/her leave account for the above reason.</p><br>
        <p>His/Her explanation should reach the undersigned within three days from the date of receipt of this Memorandum.</p>
        <br />
        <br /><br />
        <p style="text-align:right; font-size:20px; font-weight:bold;">Dy General Manager (HRD)</p>
        <br />
        <br />
        <br />
        <br />*@
    @*<p>To,</p>
        <ul>
            <li style="list-style:none;">&#10003; Copy to the Dy General Manager (&nbsp; &nbsp;  &nbsp;&nbsp; &nbsp;  &nbsp;  &nbsp;  &nbsp; &nbsp;  &nbsp;  &nbsp;  &nbsp; &nbsp; &nbsp;  &nbsp;  &nbsp; &nbsp; &nbsp;  &nbsp;  &nbsp; &nbsp;               ).</li>
            <li style="list-style:none;">&#10003; Copy submitted to EA to Managing Director.</li>
        </ul><br /><br />
        <br /><br /><br /><br /><br /><br /><br /><br /><br />*@

    @*</div>*@
</div>


@*<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/0.9.0rc1/jspdf.min.js"></script>*@
@* newly added below line by chaitanya on 8/5/2020 *@
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.0/jspdf.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.js"></script>
@*<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-beta4/html2canvas.js"></script>*@

<script>
    var doc = new jsPDF();
    var specialElementHandlers = {
        'DIV to be rendered out': function (element, renderer) {
            return true;
        }
    };

    $('#cmd').click(function () {
        
        $('#display').hide();
        $('#displayBack').hide();
        $('#displayword').hide();
        $('#latememoword').hide();
        var canvas = $(document).find('#content');

        html2canvas(document.body, {
            onrendered: function (canvas) {

                var img = canvas.toDataURL("image/jpeg");

                var imgWidth = 208;

                var pageHeight = 280;
                var imgHeight = canvas.height * imgWidth / canvas.width;
                var heightLeft = imgHeight;
                var position = 0;
                doc.addImage(img, 'JPEG', 0, 20, 210, 270)

                $('#display').show();
                $('#displayBack').show();
                $('#displayword').show();
                doc.save('LateMemo.pdf');
                //$('#display').show(); placed above the doc.save() for showing the buttons after printing the pdf;
                //$('#displayBack').show(); placed above the doc.save() for showing the buttons after printing the pdf;
            }

        });

    });
</script>

@*<script src='https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js'></script>*@

@* newly added this script section for download word document *@
<script type="text/javascript">
    //$('#cmdword').click(
        function Export2Doc(element, filename = '') {
         ;



        //  _html_ will be replace with custom html
            var meta = "Mime-Version: 1.0\nContent-Base: " + location.href + "\nContent-Type: Multipart/related; boundary=\"NEXT.ITEM-BOUNDARY\";type=\"text/html\"\n\n--NEXT.ITEM-BOUNDARY\nContent-Type: text/html; charset=\"utf-8\"\nContent-Location: " + location.href + "\n\n<!DOCTYPE html>\n<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word'xmlns='http://www.w3.org/TR/REC-html40'>\n_html_</html>";
        //  _styles_ will be replaced with custome css
            var head = "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n <!--[if gte mso 9]><xml><w:WordDocument><w:View>Print</w:View><w:Zoom>90</w:Zoom><w:DoNotOptimizeForBrowser/></w:WordDocument></xml><![endif]--> <style> \n_styles_\n</style>\n</head>\n";
        //  _body_ will be replaced with custome body html
            var body = "<body>_body_</body>";
        //var preHtml = "<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><title>Export HTML To Doc</title></head><body>";
        //var postHtml = "</body></html>";

        //var html = preHtml + document.getElementById(element).innerHTML + postHtml;
        var html = document.getElementById(element).innerHTML;

        var blob = new Blob(['\ufeff', html], {
            type: 'application/msword'
        });

        var css = (
            '<style>' +
            'img {width:300px;}' +
            '</style>'
        );
        // ************ Image Area *********************
        var options = { maxWidth: 624 };
        var images = Array();
        var img = $("#" + element).find("img");
        for (var i = 0; i < img.length; i++) {
            // Calculate dimensions of output image
            var w = Math.min(img[i].width, options.maxWidth);
            var h = img[i].height * (w / img[i].width);
            // Create canvas for converting image to data URL
            var canvas = document.createElement("CANVAS");
            canvas.width = w;
            canvas.height = h;
            // Draw image to canvas
            var context = canvas.getContext('2d');
            context.drawImage(img[i], 0, 0, w, h);
            // Get data URL encoding of image
            var uri = canvas.toDataURL("image/png");
            $(img[i]).attr("src", img[i].src);
            img[i].width = w;
            img[i].height = h;
            // Save encoded image to array
            images[i] = {
                type: uri.substring(uri.indexOf(":") + 1, uri.indexOf(";")),
                encoding: uri.substring(uri.indexOf(";") + 1, uri.indexOf(",")),
                location: $(img[i]).attr("src"),
                data: uri.substring(uri.indexOf(",") + 1)
            };
        }

        // Prepare bottom of mhtml file with image data
        var imgMetaData = "\n";
        for (var i = 0; i < images.length; i++) {
            imgMetaData += "--NEXT.ITEM-BOUNDARY\n";
            imgMetaData += "Content-Location: " + images[i].location + "\n";
            imgMetaData += "Content-Type: " + images[i].type + "\n";
            imgMetaData += "Content-Transfer-Encoding: " + images[i].encoding + "\n\n";
            imgMetaData += images[i].data + "\n\n";

        }
        imgMetaData += "--NEXT.ITEM-BOUNDARY--";
        // ****************** end Image Area *******************

        var output = meta.replace("_html_", head.replace("_styles_", css) + body.replace("_body_", html)) + imgMetaData;

        var url = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(output);


        filename = filename ? filename + '.doc' : 'LateMemo.doc';


        var downloadLink = document.createElement("a");

        document.body.appendChild(downloadLink);

        if (navigator.msSaveOrOpenBlob) {
            navigator.msSaveOrOpenBlob(blob, filename);
        } else {

            downloadLink.href = url;
            downloadLink.download = filename;
            downloadLink.click();
        }

        document.body.removeChild(downloadLink);
    }
    //});
</script>
@* end *@



