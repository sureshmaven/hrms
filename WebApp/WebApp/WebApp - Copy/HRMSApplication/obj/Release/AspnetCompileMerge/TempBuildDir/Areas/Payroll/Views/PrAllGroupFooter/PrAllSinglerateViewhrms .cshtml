@using HRMSApplication.Helpers;

@{
    /**/

    Layout = "~/Areas/Payroll/Views/Shared/_PayrollLayout.cshtml";
    var fm = ViewBag.fm;
    var rolepages = TempData["RolePages"].ToString();
    ViewBag.RolePages = TempData["RolePages"];
    var reportTitle = ViewBag.ReportTitle;
    ViewBag.Title = reportTitle + " Report";
    var dataUrl = ViewBag.DataUrl;
    var ExportColumns = ViewBag.ExportColumns;
    var PdfOrientation = ViewBag.PdfOrientation;


}
@*<style>
        #rptGrid th {
            display: none;
        }
    </style>*@
    <link href="~/Assets/css/style.css" rel="stylesheet" />
@*<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.7.5/css/bootstrap-select.min.css">*@
@*<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.7.5/js/bootstrap-select.min.js"></script>*@
<style>
        .nav-tabs > li > a {
            color: #fff;
    }
   .panel-primary {
    border-color: #337ab7;
    margin-top: 14px;
}
    #menuheader {
        display: none;
    }

    table.dataTable thead th, table.dataTable thead td {
        padding: 7px 35px;
        border-bottom: 1px solid #111;
    }

    #gridPaySlip i {
        font-size: 13px;
    }

    .navbar-default .navbar-nav > .active > a, .navbar-default .navbar-nav > .active > a:hover, .navbar-default .navbar-nav > .active > a:focus {
        background: rgba(251,180,76,0.9) !important;
        border-radius: 14px;
    }

    .navbar-nav li > a:before, .navbar-nav li > a:after {
        display: none !important;
    }

    .header-grid-left img:before {
        display: none;
    }

    .header-grid-left strong {
        float: right;
        margin: 0 10px 0 5px;
    }

    .header-grid-left ul li {
        float: left;
        font-size: 12px;
        margin: 2px 5px 0px 22px !important;
        line-height: 12px;
    }

    .header-grid-left img {
        border-radius: 50%;
        width: 20%;
        margin: -4px 8px 0 0;
    }
</style>
@{
    string rolepages1 = ViewBag.RolePages;
}

<div id="menuheader1" class="header">
    <div class="container">
        <div class="logo-nav">
            <div class="logo-nav-left col-md-2 col-sm-2 col-xs-12">
                @{

                    <a href="@Url.Action("Index", "DashBoard")"><img src="~/Assets/images/logo.png" /></a>



                }
            </div>
            <div class="logo-nav-left1 col-md-10 col-sm-10">
                <div class="row">
                    <div class="header-grid">
                        <div class="header-grid-left">
                            <ul>
                                <li class="prhide"><i class="glyphicon glyphicon-file" aria-hidden="true"></i><a href="@Url.Action("Policies", "Home")">Policies</a></li>
                                @*<li><i class="glyphicon glyphicon-file" aria-hidden="true"></i><a href="@Url.Action("Terms", "Home")">Terms of Use</a></li>*@
                                <li class="prhide"><i class="glyphicon glyphicon-earphone" aria-hidden="true"></i><a href="@Url.Action("Help", "Home")">Help</a></li>
                                @{
                                    var lActiveEmployee = Session.GetDataFromSession<string>("EmpFullName");
                                    var lActiveImage = Session.GetDataFromSession<string>("ActiveImage");
                                    if (lActiveImage != "" || lActiveImage != null)
                                    {
                                        <li><img style="width:30px; height:30px;" src="~/uploads/@lActiveImage" />Welcome! <strong> @lActiveEmployee </strong></li>
                                    }
                                    else
                                    {
                                        <li><img style="width:30px; height:30px;" src="~/uploads/m.png" />Welcome! <strong> @lActiveEmployee </strong></li>
                                    }
                                }
                                <li><i class="glyphicon glyphicon-log-in" aria-hidden="true"></i><a href="@Url.Action("Logout", "Home" )" class="login">Logout</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="clearfix"></div>
                    <nav class="navbar navbar-default">

                        <div class="navbar-header">
                            <button type="button" class="navbar-toggle collapsed navbar-toggle1" data-toggle="collapse" data-target="#bs-megadropdown-tabs">Menu <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button>
                        </div>
                        <div class="collapse navbar-collapse" id="bs-megadropdown-tabs">
                            <ul class="nav navbar-nav">
                                @{

                                    if (rolepages != null)
                                    {

                                        if (rolepages.Contains("DBMain"))
                                        {
                                            <li id="a9"><a href="@Url.Action("Index", "DashBoard")">DashBoard</a></li>
                                        }
                                        if (rolepages.Contains("EDMain"))
                                        {
                                            <li id="a9"><a href="@Url.Action("EmployeeDashBoard", "DashBoard")">DashBoard</a></li>
                                        }
                                        if (rolepages.Contains("MPMain"))
                                        {
                                            <li id="a3"><a href="@Url.Action("ViewProfile", "Register")">My Profile</a></li>
                                        }
                                        if (rolepages.Contains("LEMain"))
                                        {
                                            <li id="a4"><a href="@Url.Action("LeaveRequest","LeaveApply")">Leaves</a></li>
                                        }
                                        if (rolepages.Contains("ODMain"))
                                        {
                                            <li id="a7"><a href="@Url.Action("Index","Duty")">OD</a></li>
                                        }
                                        if (rolepages.Contains("LTMain"))
                                        {
                                            <li id="a8"><a href="@Url.Action("Index", "LeaveTravel")">LTC</a></li>
                                        }
                                        if (rolepages.Contains("PLMain"))
                                        {
                                            <li id="a10"><a href="@Url.Action("Index", "PLE_Type")">PL Encashment</a></li>
                                        }
                                        if (rolepages.Contains("WDMain"))
                                        {
                                            <li id="a11"><a href="@Url.Action("Index", "WorkDiary")">WorkDiary</a></li>
                                        }
                                        if (rolepages.Contains("WDAPLMain"))
                                        {
                                            <li id="a11"><a href=@Url.Action("WorkApproval", "WorkDiary")>WorkDiary</a></li>
                                        }
                                        if (rolepages.Contains("WDSHYMain"))
                                        {
                                            <li id="a11">  <a href=@Url.Action("SanctionWorkApproval", "WorkDiary")>WorkDiary</a></li>
                                        }
                                        if (rolepages.Contains("TsheetMain"))
                                        {
                                            <li id="at"><a href="@Url.Action("Timesheetrequestform", "TimeSheet")">TimeSheet Manual Form</a></li>
                                        }

                                        if (rolepages.Contains("Payslip"))
                                        {
                                            <li id="at" class="active"><a href="@Url.Action("PayslipReporthrms", "PrAllReports")">Payroll</a></li>

                                        }
                                        @*if (rolepages.Contains("PRMain"))
                                            {
                                                <li id="at"><a href="@Url.Action("Index", "Payroll")">payroll</a></li>}*@
                                        @*if (rolepages.Contains("POMain"))
                                            {
                                                <li id="a5"><a href="@Url.Action("Policies", "Home")">Policies</a></li>}*@
                                        if (rolepages.Contains("ADMain"))
                                        {
                                            <li id="a1"><a href="@Url.Action("InsertEmployees", "Register")">Admin</a></li>
                                        }
                                        if (rolepages.Contains("MAMain"))
                                        {

                                            <li id="a2"><a href="@Url.Action("Create","Banks")">Master</a></li>
                                        }
                                        if (rolepages.Contains("MABlock"))
                                        {
                                            <li id="a2"><a href="@Url.Action("Create", "BlockPeriod")">Master</a></li>
                                        }
                                        if (rolepages.Contains("MANews"))
                                        {
                                            <li id="a2"><a href="@Url.Action("Create", "News")">Master</a></li>
                                        }

                                        if (rolepages.Contains("RPMain"))
                                        {
                                            <li id="a6"><a href="@Url.Action("Index", "AllReports")">Reports</a></li>
                                        }



                                        @*if (rolepages.Contains("TsheetApp"))
                                            {
                                                <li id="at1"><a href=@Url.Action("TSApprovalView", "TimeSheet")>TS Approvals</a></li>}*@
                                    }
                                }
                            </ul>
                        </div>
                    </nav>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="container">
    <div class="panel with-nav-tabs panel-primary">
        <div class="panel-heading">
            @{
                <ul class="nav nav-tabs">
                    @if (rolepages.Contains("Payslip"))
                    {
                        <li><a href="@Url.Action("PayslipReporthrms", "PrAllReports")">Payslip</a></li>
                    }
                    @if (rolepages.Contains("Payslip"))
                    {
                        <li><a href="@Url.Action("Pfcontributioncardhrms", "PrAllGroupFooter")">PF ContributionCard</a></li>
                    }
                    @if (rolepages.Contains("Payslip"))
                    {
                        <li><a href="@Url.Action("TDSReporthrms", "PrAllReports")">TDS</a></li>
                    }
                    @if (rolepages.Contains("Payslip"))
                    {
                        <li  id="at" class="active"><a href="@Url.Action("SingleRateLoanOutStandinghrms", "PrAllGroupFooter")">Single Rate</a></li>
                    }
                </ul>
            }
        </div>
 </div>
        <div class="page_st">

            <div class="page">
                <div class="form-horizontal form-horizontal2">
                    <div class="page_start">
                        <div class="leftmenu-container">
                            <div class="sidebar-content">
                                <div class="main_heading heading_main">
                                    <h1>@ViewBag.ReportTitle</h1>
                                    <div class="col-md-12">
                                        <div class="fancy-collapse-panel">
                                            <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
                                                <div class="panel panel-default">
                                                    <div class="panel-heading" role="tab" id="headingOne">
                                                        <h4 class="panel-title">
                                                            <a data-toggle="collapse" data-parent="#accordion" href="#reportsearch" aria-expanded="true" aria-controls="reportsearch">
                                                                Report Filter
                                                            </a>
                                                        </h4>
                                                    </div>
                                                    <div id="reportsearch" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
                                                        <div class="panel-body">
                                                            <div class="reports_search">
                                                                <div class="rep_down_fields">
                                                                    @{

                                                             if (ViewBag.ReportFiltersTemplate == "T11-OneRadioButtonOneMonthPicker")
                                                            {
                                                                <div class="reports_search">
                                                                    @*<div class="col-md-2">@{Html.RenderPartial("LoansPopUp");}</div>*@
                                                                    <div class="col-md-4">

                                                                        <div class="form-group">
                                                                            <label class="col-sm-4 control-label dept_label">@ViewBag.OneMonthPickerLabel1</label>
                                                                            <div class="col-sm-8 mul_drop">
                                                                                <div class="date input-group p0" id="dtOneMonthPickerYear">
                                                                                    <input type="text" class="form-control form-control-1 input-sm from fromFudis" placeholder="Select-Month" id="dtOneMonthPicker">
                                                                                    <span class="input-group-addon">
                                                                                        <span class="glyphicon glyphicon-calendar"></span>
                                                                                    </span>
                                                                                </div>
                                                                            </div>

                                                                        </div>


                                                                    </div>
                                                                    <div class="col-md-2">
                                                                        <div class="pull-right">
                                                                            <button class="btn btn-primary" id="BtnSearchLoansWithdate">Search</button>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            }





                                                                    }
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-12">
                                        <div class="table-responsive ">
                                            <table id="rptGrid" class="display reports-grids" title="hidden" cellspacing="0" style="width:100%"></table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>

        $(document).ready(function () {
            $('#txtAllEmpSearchforLoansAndSchedules2').hide();
            $('#txtAllEmpSearchforLoansAndSchedules1').hide();
            $('#txtAllEmpSearchforBranchs').hide();
            $('#checkboxAll').prop('checked', false);
            //setTimeout(pageInitLoad(), 2000);
        });
        //loans popup
        function fillLoantypeDetails() {

            CommonApiGET('/Payroll/Masters/GetLoanTypeDetailsforReport?LoanId=' + $("#txtAllEmpSearchforLoansAndSchedules1").val(), function (respData) {

                var lt = [];
                var dataObj = JSON.parse(respData);
                lt.push(dataObj.LTDetails);
                var ltData = lt[0];
                orgLTlist = ltData;

                if (respData.length == 0) {
                    toasterOptions();
                    toastr.error('No user with Name / Code: ' + $("#txtAllEmpSearchforLoansAndSchedules1").val(), 'No user');
                    setTimeout(function () { window.location.reload(); }, g_pagereload_seconds);
                }

                else if (respData.length > 0) {
                    $("#adv_loans_modal").modal();
                    $('#gridLoantype').DataTable({
                        "bFilter": true,
                        "destroy": true,
                        "paging": false,
                        "info": false,
                        // cmTemplate: { sortable: false },
                        // sortable: false,
                        "language": {
                            "search": "Filter records:"
                        },

                        data: ltData,

                        "columns": [
                            {

                                "mData": null,
                                "bSortable": false,
                                "mRender": function (data, type, full) {
                                    var array = $('#txtAllEmpSearchforLoansAndSchedules1').val().split(",");
                                    $.each(array, function (i) {
                                        $("input[value='" + array[i] + "']").prop('checked', true);
                                    });

                                    return '<input id="checkbox1" type="checkbox" name="checkbox" value="' + data.id + '" ><label><span></span></label>';
                                }
                            },
                            { "data": "id", "visible": false },
                            { "data": "loan_description" },

                        ],

                        "order": [[0, 'asc']]
                    });
                }
            });

        }
        //schedules popup
        function fillScheduletypeDetails() {

            CommonApiGET('/Payroll/Common/SearchEmployeeWithScheduleNames?LoanId=' + $("#txtAllEmpSearchforLoansAndSchedules2").val(), function (respData) {

                var lt = [];
                var dataObj = JSON.parse(respData);
                lt.push(dataObj.LTDetails);
                var ltData = lt[0];
                orgLTlist = ltData;

                if (respData.length == 0) {
                    toasterOptions();
                    toastr.error('No user with Name / Code: ' + $("#txtAllEmpSearchforLoansAndSchedules2").val(), 'No user');
                    setTimeout(function () { window.location.reload(); }, g_pagereload_seconds);
                }

                else if (respData.length > 0) {
                    $("#adv_Schedule_modal").modal();
                    $('#gridScheduletype').DataTable({
                        "bFilter": true,
                        "destroy": true,
                        "paging": false,
                        "info": false,
                        "language": {
                            "search": "Filter records:"
                        },
                        data: ltData,

                        "columns": [
                            {
                                "mData": null,
                                "bSortable": false,
                                "mRender": function (data, type, full) {

                                    var array = $('#txtAllEmpSearchforLoansAndSchedules2').val().split(",");
                                    $.each(array, function (i) {
                                        $("input[value='" + array[i] + "']").prop('checked', true);
                                    });

                                    return '<input id="checkbox1" type="checkbox" name="checkbox1" value="' + data.Id + '" ><label><span></span></label>';
                                }
                            },
                            { "data": "Id", "visible": false },
                            { "data": "Name" },

                        ],
                        "order": [[0, 'asc']]
                    });
                }
            });

        }
        //branch
        function fillBranchDetails() {

            CommonApiGET('/Payroll/PrAllGroupFooter/GetBranches?BranchId=' + $("#txtAllEmpSearchforBranchs").val(), function (respData) {

                var lt = [];
                var dataObj = JSON.parse(respData);
                lt.push(dataObj.LTDetails);
                var ltData = lt[0];
                orgLTlist = ltData;

                if (respData.length == 0) {
                    toasterOptions();
                    toastr.error('No user with Name / Code: ' + $("#txtAllEmpSearchforBranchs").val(), 'No user');
                    setTimeout(function () { window.location.reload(); }, g_pagereload_seconds);
                }

                else if (respData.length > 0) {
                    $("#branch_models").modal();
                    $('#gridBranch').DataTable({
                        "bFilter": true,
                        "destroy": true,
                        "paging": false,
                        "info": false,
                        "language": {
                            "search": "Filter records:"
                        },
                        data: ltData,

                        "columns": [
                            {
                                "mData": null,
                                "bSortable": false,
                                "mRender": function (data, type, full) {

                                    var array = $('#txtAllEmpSearchforBranchs').val().split(",");
                                    $.each(array, function (i) {
                                        $("input[value='" + array[i] + "']").prop('checked', true);
                                    });

                                    return '<input id="checkbox1" type="checkbox" name="checkbox1" value="' + data.Id + '" ><label><span></span></label>';
                                }
                            },
                            { "data": "Id", "visible": false },
                            { "data": "Name" },

                        ],
                        "order": [[0, 'asc']]
                    });
                }
            });

        }

    </script>
    <script>
    var ReportColumnsCount = '@ViewBag.ReportColumnsCount';
    var ReportFooterColumnsCount = '@ViewBag.ReportFooterColumnsCount';
    var reportMsgTop = '';
    var fnMessageTop = function () {
        return (reportMsgTop == '' ? '' : 'Filters : ' + reportMsgTop);
    };
    var pdf = '@ViewBag.Removepdf';
    $(document).ready(function () {
        if (pdf == "RemovePdf")
        {
            setTimeout(pageInitLoadRemovePdf(), 2000);
        }
        else if ('@reportTitle' == 'PF Fund' || '@reportTitle' == "Pension Annual Report(Form :8)" || '@reportTitle' == "EMPLOYEES CONTRIBUTION LEDGER FOR THE CONTRIBUTION EFFECTIVE MONTH")
        {
            setTimeout(pffundpageInitLoad(), 2000);
        }
        else {
            setTimeout(pageInitLoad(), 2000);
        }
    });
    function pffundpageInitLoad() {
        var serviceurl = '@dataUrl';
        serviceurl = serviceurl.replace('&amp;', '&');
        $('#rptGrid').DataTable({
            "paging": true,
            //scrollX: true,
            //scrollCollapse: true,
            "language": {
                "search": "Filter records:"
            },
            //"language": {
            //    "emptyTable": "No data available. Please enter employee code and search"
            //},
            //"destroy" : true,
            "ajax": {
                "url": serviceurl,
                "type": "GET",
                "datatype": "json",
                "dataSrc": ""

            },
            dom: 'Bfrtip',
            buttons: [
              {
                  extend: 'excelHtml5',
                  text: '<i class="fa fa-file-excel-o dt-export-icon-excel"></i>',
                  titleAttr: 'Excel',
                  title: '@reportTitle',
                  messageTop: fnMessageTop,
                  exportOptions: {@ExportColumns},
                  className: 'dt-export-btn',
                  color: 'red',
                  //customizeData: function (data,row,dataIndex ) {
                  //   // debugger;
                  //    for (var i=0; i<data.body.length; i++){
                  //        for (var j=0; j<data.body[i].length; j++ ){
                  //            var stringdata= data.body[i][j];
                  //            stringdata = stringdata.replace("~", "");
                  //            console.log( $(this).text());
                  //            data.body[i][j] = stringdata;
                  //            $(this).attr( 's', '40' );
                  //            // $(row).css('background-color', 'Red');
                  //            // $(this).data('ci', stringdata);
                  //            data.body[i][j] .fillColor="red";

                  //        }
                  //    }
                  //  }
                    customize: function (xlsx) {
                        var sheet = xlsx.xl.worksheets['sheet1.xml'];
                        //sai

                        $('row c[r^="A"]', sheet).each(function () {
                            inputString = $('is t', this).text();


                            if (inputString.indexOf("~") > -1) {
                                s = inputString.replace("~", "");
                                s = $.trim(s);
                                console.log(s);
                                var s = s.replace("^", "")
                                $('is t', this).text(s);
                                //$(this).attr('s', '55');
                                $(this).attr('s', '17');

                            }


                            if (inputString.indexOf("^") > -1) {
                                s = inputString.replace("^", "");
                                $('is t', this).text(s);

                            }

                        });

                        // for Row B
                        $('row c[r^="B"]', sheet).each(function () {
                            inputString = $('is t', this).text();
                            if (inputString.startsWith("`")) {
                                s = inputString.replace("`", "");
                                $('is t', this).text(s);
                                $(this).attr('s', '17');
                            }

                        });
                        // for Row C
                        $('row c[r^="C"]', sheet).each(function () {
                            inputString = $('is t', this).text();
                            if (inputString.startsWith("`")) {
                                s = inputString.replace("`", "");
                                $('is t', this).text(s);
                                $(this).attr('s', '17');
                            }

                        });
                        // for Row D
                        $('row c[r^="D"]', sheet).each(function () {
                            inputString = $('is t', this).text();
                            if (inputString.startsWith("`")) {
                                s = inputString.replace("`", "");
                                $('is t', this).text(s);
                                $(this).attr('s', '17');
                            }

                        });
                        // for Row E
                        $('row c[r^="E"]', sheet).each(function () {
                            inputString = $('is t', this).text();
                            if (inputString.startsWith("`")) {
                                s = inputString.replace("`", "");
                                $('is t', this).text(s);
                                $(this).attr('s', '17');
                            }

                        });
                        // for Row F
                        $('row c[r^="F"]', sheet).each(function () {
                            inputString = $('is t', this).text();
                            if (inputString.startsWith("`")) {
                                s = inputString.replace("`", "");
                                $('is t', this).text(s);
                                $(this).attr('s', '17');
                            }

                        });
                        // for Row G
                        $('row c[r^="G"]', sheet).each(function () {
                            inputString = $('is t', this).text();
                            if (inputString.startsWith("`")) {
                                s = inputString.replace("`", "");
                                $('is t', this).text(s);
                                $(this).attr('s', '17');
                            }

                        });
                        // for Row H
                        $('row c[r^="H"]', sheet).each(function () {
                            inputString = $('is t', this).text();
                            if (inputString.startsWith("`")) {
                                s = inputString.replace("`", "");
                                $('is t', this).text(s);
                                $(this).attr('s', '17');
                            }

                        });

                        // for Row I
                        $('row c[r^="I"]', sheet).each(function () {
                            inputString = $('is t', this).text();
                            if (inputString.startsWith("`")) {
                                s = inputString.replace("`", "");
                                $('is t', this).text(s);
                                $(this).attr('s', '17');
                            }

                        });
                        // for Row J
                        $('row c[r^="J"]', sheet).each(function () {
                            inputString = $('is t', this).text();
                            if (inputString.startsWith("`")) {
                                s = inputString.replace("`", "");
                                $('is t', this).text(s);
                                $(this).attr('s', '17');
                            }

                        });
                        // for Row K
                        $('row c[r^="K"]', sheet).each(function () {
                            inputString = $('is t', this).text();
                            if (inputString.startsWith("`")) {
                                s = inputString.replace("`", "");
                                $('is t', this).text(s);
                                $(this).attr('s', '17');
                            }

                        });
                        // for Row L
                        $('row c[r^="L"]', sheet).each(function () {
                            inputString = $('is t', this).text();
                            if (inputString.startsWith("`")) {
                                s = inputString.replace("`", "");
                                $('is t', this).text(s);
                                $(this).attr('s', '17');
                            }

                        });
                        // for Row M
                        $('row c[r^="M"]', sheet).each(function () {
                            inputString = $('is t', this).text();
                            if (inputString.startsWith("`")) {
                                s = inputString.replace("`", "");
                                $('is t', this).text(s);
                                $(this).attr('s', '17');
                            }

                        });
                        // for Row N
                        $('row c[r^="N"]', sheet).each(function () {
                            inputString = $('is t', this).text();
                            if (inputString.startsWith("`")) {
                                s = inputString.replace("`", "");
                                $('is t', this).text(s);
                                $(this).attr('s', '17');
                            }

                        });
                        // for Row o
                        $('row c[r^="O"]', sheet).each(function () {
                            inputString = $('is t', this).text();
                            if (inputString.startsWith("`")) {
                                s = inputString.replace("`", "");
                                $('is t', this).text(s);
                                $(this).attr('s', '17');
                            }

                        });
                    },
              },

              {
                  extend: 'pdfHtml5',
                  text: '<i class="fa fa-file-pdf-o dt-export-icon-pdf"></i>',
                  className: 'dt-export-btn',
                  titleAttr: 'Pdf',
                  title: '@reportTitle',
                  orientation: '@PdfOrientation',
                  exportOptions: {@ExportColumns},
                  messageTop: fnMessageTop,
                  customize: function (doc) {

                      doc.styles.tableHeader.alignment = 'left';
                      doc.content.splice(1, 0, {
                          margin: [0, -50, 0, 10],
                          alignment: 'left',
                          image: 'data:image/png;base64,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'
                      });
                      var bod = [];
                      var docIdx = reportMsgTop != '' ? 3 : 2;
                      doc.content[docIdx].table.body.forEach(function (line, i) {
                          if (i < doc.content[docIdx].table.body.length) {
                              if (line[0].text.startsWith('~')) { //header
                                  bod.push([
                                      { text: PdfHeaderFormat(line[0].text), colSpan: ReportColumnsCount, fillColor: '#C8EAFB' },
                                  ]);
                              }
                              else if (line[0].text.startsWith('^')) { //footer

                                  bod.push([
                                      { text: PdfFooterFormat(line[0].text),colSpan: ReportColumnsCount, fillColor: '#eef8fd' },
                                  ]);
                              }
                              else { //body rows
                                  var arrBodyPush = [];
                                  for (var y = 0; y < ReportColumnsCount; y++) {
                                      arrBodyPush.push({ text: line[y].text, style: 'defaultStyle' });
                                  }
                                  bod.push(arrBodyPush);

                              }
                          }
                      });

                      doc.content[docIdx].table.body = bod;
                      doc.content[docIdx].layout = 'lightHorizontalLines';

                      doc.content[0].text = doc.content[0].text.trim();
                      doc.styles.title = {
                          fontSize: '20',
                          alignment: 'center'
                      };
                      doc.styles.message = {
                          fontSize: '9',
                          alignment: 'center'
                      };

                      doc['footer'] = (function (page, pages) {
                          return {
                              columns: [
                                  'By: @ViewBag.LoginUserName , @ViewBag.LoginBranchName .',
                                  {
                                      alignment: 'right',
                                      text: [
                                          new Date().toLocaleDateString("en-IN", { day: "2-digit", month: "2-digit", year: "numeric", hour: '2-digit', minute: '2-digit' }),
                                          '    Page ', { text: page.toString() }, ' of ', { text: pages.toString() }
                                      ]
                                  }
                              ],
                              fontSize: '9',
                              margin: [40, 10]
                          }
                      });
                  }
              }
            ],
            "columns": @Html.Raw(ViewBag.ReportColumns),
            "rowCallback": function (row, data, index) {
                //
                if (data.HRF=="H") {
                    $('td', row).css('background-color', '#C8EAFB');
                    $('td:eq(0)', row).attr('colspan', ReportColumnsCount);
                    for (y = 1; y < ReportColumnsCount; y++) {
                        $('td:eq('+ y +')', row).css('display', 'none');
                    }
                }
                else if (data.HRF=="F")
                {
                    //debugger;
                    //$('td', row).css('background-color', '#eef8fd');
                    //$('td:eq(0)', row).attr('colspan', 0);
                    //for (y = 1; y < 0; y++) {
                    //    // $nextTD = $(this).closest('td').next();
                    //    $('td :eq('+ y +')', row).css('display', 'none');
                    //}
                    $('td', row).css('background-color', '#eef8fd');
                    $('td:eq(0)', row).attr('colspan', ReportFooterColumnsCount);
                    for (y = 1; y < ReportFooterColumnsCount; y++) {
                        $('td:eq(' + y + ')', row).css('display', 'none');
                    }

                }
                else if (data.HRF == "D") {
                    //debugger;
                    //$('td', row).css('background-color', '#eef8fd');
                    //$('td:eq(0)', row).attr('colspan', 0);
                    //for (y = 1; y < 0; y++) {
                    //    // $nextTD = $(this).closest('td').next();
                    //    $('td :eq('+ y +')', row).css('display', 'none');
                    //}
                    $('td', row).css('background-color', '#d5e6c2');
                    $('td:eq(0)', row).attr('colspan', ReportFooterColumnsCount);
                    for (y = 1; y < ReportFooterColumnsCount; y++) {
                        $('td:eq(' + y + ')', row).css('display', 'none');
                    }

                }
            }
        });
    };


    function pageInitLoad() {
        var serviceurl = '@dataUrl';
        serviceurl = serviceurl.replace('&amp;', '&');
        $('#rptGrid').DataTable({
            "paging": false,
            //scrollX: true,
            //scrollCollapse: true,
            "language": {
                "search": "Filter records:"
            },
            //"language": {
            //    "emptyTable": "No data available. Please enter employee code and search"
            //},
            //"destroy" : true,
            "ajax": {
                "url": serviceurl,
                "type": "GET",
                "datatype": "json",
                "dataSrc": ""

            },
            dom: 'Bfrtip',
            buttons: [
              {
                  extend: 'excelHtml5',
                  text: '<i class="fa fa-file-excel-o dt-export-icon-excel"></i>',
                  titleAttr: 'Excel',
                  title: '@reportTitle',
                  messageTop: fnMessageTop,
                  exportOptions: {@ExportColumns},
                  className: 'dt-export-btn',
                  color: 'red',
                  //customizeData: function (data,row,dataIndex ) {
                  //   // debugger;
                  //    for (var i=0; i<data.body.length; i++){
                  //        for (var j=0; j<data.body[i].length; j++ ){
                  //            var stringdata= data.body[i][j];
                  //            stringdata = stringdata.replace("~", "");
                  //            console.log( $(this).text());
                  //            data.body[i][j] = stringdata;
                  //            $(this).attr( 's', '40' );
                  //            // $(row).css('background-color', 'Red');
                  //            // $(this).data('ci', stringdata);
                  //            data.body[i][j] .fillColor="red";

                  //        }
                  //    }
                  //  }
                    customize: function (xlsx) {
                        var sheet = xlsx.xl.worksheets['sheet1.xml'];
                        //sai

                        $('row c[r^="A"]', sheet).each(function () {
                            inputString = $('is t', this).text();


                            if (inputString.indexOf("~") > -1) {
                                s = inputString.replace("~", "");
                                s = $.trim(s);
                                console.log(s);
                                var s = s.replace("^", "")
                                $('is t', this).text(s);
                                //$(this).attr('s', '55');
                                $(this).attr('s', '17');

                            }


                            if (inputString.indexOf("^") > -1) {
                                s = inputString.replace("^", "");
                                $('is t', this).text(s);

                            }

                        });

                        // for Row B
                        $('row c[r^="B"]', sheet).each(function () {
                            inputString = $('is t', this).text();
                            if (inputString.startsWith("`")) {
                                s = inputString.replace("`", "");
                                $('is t', this).text(s);
                                $(this).attr('s', '17');
                            }

                        });
                        // for Row C
                        $('row c[r^="C"]', sheet).each(function () {
                            inputString = $('is t', this).text();
                            if (inputString.startsWith("`")) {
                                s = inputString.replace("`", "");
                                $('is t', this).text(s);
                                $(this).attr('s', '17');
                            }

                        });
                        // for Row D
                        $('row c[r^="D"]', sheet).each(function () {
                            inputString = $('is t', this).text();
                            if (inputString.startsWith("`")) {
                                s = inputString.replace("`", "");
                                $('is t', this).text(s);
                                $(this).attr('s', '17');
                            }

                        });
                        // for Row E
                        $('row c[r^="E"]', sheet).each(function () {
                            inputString = $('is t', this).text();
                            if (inputString.startsWith("`")) {
                                s = inputString.replace("`", "");
                                $('is t', this).text(s);
                                $(this).attr('s', '17');
                            }

                        });
                        // for Row F
                        $('row c[r^="F"]', sheet).each(function () {
                            inputString = $('is t', this).text();
                            if (inputString.startsWith("`")) {
                                s = inputString.replace("`", "");
                                $('is t', this).text(s);
                                $(this).attr('s', '17');
                            }

                        });
                        // for Row G
                        $('row c[r^="G"]', sheet).each(function () {
                            inputString = $('is t', this).text();
                            if (inputString.startsWith("`")) {
                                s = inputString.replace("`", "");
                                $('is t', this).text(s);
                                $(this).attr('s', '17');
                            }

                        });
                        // for Row H
                        $('row c[r^="H"]', sheet).each(function () {
                            inputString = $('is t', this).text();
                            if (inputString.startsWith("`")) {
                                s = inputString.replace("`", "");
                                $('is t', this).text(s);
                                $(this).attr('s', '17');
                            }

                        });

                        // for Row I
                        $('row c[r^="I"]', sheet).each(function () {
                            inputString = $('is t', this).text();
                            if (inputString.startsWith("`")) {
                                s = inputString.replace("`", "");
                                $('is t', this).text(s);
                                $(this).attr('s', '17');
                            }

                        });
                        // for Row J
                        $('row c[r^="J"]', sheet).each(function () {
                            inputString = $('is t', this).text();
                            if (inputString.startsWith("`")) {
                                s = inputString.replace("`", "");
                                $('is t', this).text(s);
                                $(this).attr('s', '17');
                            }

                        });
                        // for Row K
                        $('row c[r^="K"]', sheet).each(function () {
                            inputString = $('is t', this).text();
                            if (inputString.startsWith("`")) {
                                s = inputString.replace("`", "");
                                $('is t', this).text(s);
                                $(this).attr('s', '17');
                            }

                        });
                        // for Row L
                        $('row c[r^="L"]', sheet).each(function () {
                            inputString = $('is t', this).text();
                            if (inputString.startsWith("`")) {
                                s = inputString.replace("`", "");
                                $('is t', this).text(s);
                                $(this).attr('s', '17');
                            }

                        });
                        // for Row M
                        $('row c[r^="M"]', sheet).each(function () {
                            inputString = $('is t', this).text();
                            if (inputString.startsWith("`")) {
                                s = inputString.replace("`", "");
                                $('is t', this).text(s);
                                $(this).attr('s', '17');
                            }

                        });
                        // for Row N
                        $('row c[r^="N"]', sheet).each(function () {
                            inputString = $('is t', this).text();
                            if (inputString.startsWith("`")) {
                                s = inputString.replace("`", "");
                                $('is t', this).text(s);
                                $(this).attr('s', '17');
                            }

                        });
                        // for Row o
                        $('row c[r^="O"]', sheet).each(function () {
                            inputString = $('is t', this).text();
                            if (inputString.startsWith("`")) {
                                s = inputString.replace("`", "");
                                $('is t', this).text(s);
                                $(this).attr('s', '17');
                            }

                        });
                    },
              },

              {
                  extend: 'pdfHtml5',
                  text: '<i class="fa fa-file-pdf-o dt-export-icon-pdf"></i>',
                  className: 'dt-export-btn',
                  titleAttr: 'Pdf',
                  title: '@reportTitle',
                  orientation: '@PdfOrientation',
                  exportOptions: {@ExportColumns},
                  messageTop: fnMessageTop,
                  customize: function (doc) {

                      doc.styles.tableHeader.alignment = 'left';
                      doc.content.splice(1, 0, {
                          margin: [0, -50, 0, 10],
                          alignment: 'left',
                          image: 'data:image/png;base64,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'
                      });
                      var bod = [];
                      var docIdx = reportMsgTop != '' ? 3 : 2;
                      doc.content[docIdx].table.body.forEach(function (line, i) {
                          if (i < doc.content[docIdx].table.body.length) {
                              if (line[0].text.startsWith('~')) { //header
                                  bod.push([
                                      { text: PdfHeaderFormat(line[0].text), colSpan: ReportColumnsCount, fillColor: '#C8EAFB' },
                                  ]);
                              }
                              else if (line[0].text.startsWith('^')) { //footer

                                  bod.push([
                                      { text: PdfFooterFormat(line[0].text),colSpan: ReportColumnsCount, fillColor: '#eef8fd' },
                                  ]);
                              }
                              else { //body rows
                                  var arrBodyPush = [];
                                  for (var y = 0; y < ReportColumnsCount; y++) {
                                      arrBodyPush.push({ text: line[y].text, style: 'defaultStyle' });
                                  }
                                  bod.push(arrBodyPush);

                              }
                          }
                      });

                      doc.content[docIdx].table.body = bod;
                      doc.content[docIdx].layout = 'lightHorizontalLines';

                      doc.content[0].text = doc.content[0].text.trim();
                      doc.styles.title = {
                          fontSize: '20',
                          alignment: 'center'
                      };
                      doc.styles.message = {
                          fontSize: '9',
                          alignment: 'center'
                      };

                      doc['footer'] = (function (page, pages) {
                          return {
                              columns: [
                                  'By: @ViewBag.LoginUserName , @ViewBag.LoginBranchName .',
                                  {
                                      alignment: 'right',
                                      text: [
                                          new Date().toLocaleDateString("en-IN", { day: "2-digit", month: "2-digit", year: "numeric", hour: '2-digit', minute: '2-digit' }),
                                          '    Page ', { text: page.toString() }, ' of ', { text: pages.toString() }
                                      ]
                                  }
                              ],
                              fontSize: '9',
                              margin: [40, 10]
                          }
                      });
                  }
              }
            ],
            "columns": @Html.Raw(ViewBag.ReportColumns),
            "rowCallback": function (row, data, index) {
                //
                if (data.HRF=="H") {
                    $('td', row).css('background-color', '#C8EAFB');
                    $('td:eq(0)', row).attr('colspan', ReportColumnsCount);
                    for (y = 1; y < ReportColumnsCount; y++) {
                        $('td:eq('+ y +')', row).css('display', 'none');
                    }
                }
                else if (data.HRF=="F")
                {
                    //debugger;
                    //$('td', row).css('background-color', '#eef8fd');
                    //$('td:eq(0)', row).attr('colspan', 0);
                    //for (y = 1; y < 0; y++) {
                    //    // $nextTD = $(this).closest('td').next();
                    //    $('td :eq('+ y +')', row).css('display', 'none');
                    //}
                    $('td', row).css('background-color', '#eef8fd');
                    $('td:eq(0)', row).attr('colspan', ReportFooterColumnsCount);
                    for (y = 1; y < ReportFooterColumnsCount; y++) {
                        $('td:eq(' + y + ')', row).css('display', 'none');
                    }

                }
                else if (data.HRF == "D") {
                    //debugger;
                    //$('td', row).css('background-color', '#eef8fd');
                    //$('td:eq(0)', row).attr('colspan', 0);
                    //for (y = 1; y < 0; y++) {
                    //    // $nextTD = $(this).closest('td').next();
                    //    $('td :eq('+ y +')', row).css('display', 'none');
                    //}
                    $('td', row).css('background-color', '#d5e6c2');
                    $('td:eq(0)', row).attr('colspan', ReportFooterColumnsCount);
                    for (y = 1; y < ReportFooterColumnsCount; y++) {
                        $('td:eq(' + y + ')', row).css('display', 'none');
                    }

                }
            }
        });
    };

    function pageInitLoadRemovePdf() {
        var serviceurl = '@dataUrl';
        serviceurl = serviceurl.replace('&amp;', '&');

        $('#rptGrid').DataTable({
            "paging": false,
            "language": {
                "search": "Filter records:"
            },
            "ajax": {
                "url": serviceurl,
                "type": "GET",
                "datatype": "json",
                "dataSrc": ""
            },
            dom: 'Bfrtip',
            buttons: [
              {
                  extend: 'excelHtml5',
                  text: '<i class="fa fa-file-excel-o dt-export-icon-excel"></i>',
                  titleAttr: 'Excel',
                  title: '@reportTitle',
                  messageTop: fnMessageTop,
                  exportOptions: {@ExportColumns},
                  className: 'dt-export-btn',
                  color: 'red',
                  //customize: function (xlsx) {
                  //    var sheet = xlsx.xl.worksheets['sheet1.xml'];
                  //    $('row c[r]', sheet).each( function () {
                  //        if ( $(this).text().startsWith('~')) {
                  //            $(this).text().replace('','~') ;
                  //            $(this).attr( 's', '42' );
                  //        }
                  //    });

                  //  }


                  //tsum

                    customize: function (xlsx) {
                        var sheet = xlsx.xl.worksheets['sheet1.xml'];
                        //sai

                        //$('row c[r^="A"]', sheet).each(function () {
                        //    inputString = $('is t', this).text();
                        //    if (inputString.indexOf("~") > -1) {
                        //        s = inputString.replace("~", "");
                        //        var s = s.replace("^", "")
                        //        $('is t', this).text(s);
                        //        $(this).attr('s', '17');
                        //    }
                        //    if (inputString.indexOf("^") > -1) {
                        //        s = inputString.replace("^", "");
                        //        $('is t', this).text(s);

                        //    }

                        //});

                        //// for Row B
                        //$('row c[r^="B"]', sheet).each(function () {
                        //    inputString = $('is t', this).text();
                        //    if (inputString.startsWith("`")) {
                        //        s = inputString.replace("`", "");
                        //        $('is t', this).text(s);
                        //        $(this).attr('s', '17');
                        //    }

                        //});
                        //// for Row C
                        //$('row c[r^="C"]', sheet).each(function () {
                        //    inputString = $('is t', this).text();
                        //    if (inputString.startsWith("`")) {
                        //        s = inputString.replace("`", "");
                        //        $('is t', this).text(s);
                        //        $(this).attr('s', '17');
                        //    }

                        //});
                        //// for Row D
                        //$('row c[r^="D"]', sheet).each(function () {
                        //    inputString = $('is t', this).text();
                        //    if (inputString.startsWith("`")) {
                        //        s = inputString.replace("`", "");
                        //        $('is t', this).text(s);
                        //        $(this).attr('s', '17');
                        //    }

                        //});
                        //// for Row E
                        //$('row c[r^="E"]', sheet).each(function () {
                        //    inputString = $('is t', this).text();
                        //    if (inputString.startsWith("`")) {
                        //        s = inputString.replace("`", "");
                        //        $('is t', this).text(s);
                        //        $(this).attr('s', '17');
                        //    }

                        //});
                        //// for Row F
                        //$('row c[r^="F"]', sheet).each(function () {
                        //    inputString = $('is t', this).text();
                        //    if (inputString.startsWith("`")) {
                        //        s = inputString.replace("`", "");
                        //        $('is t', this).text(s);
                        //        $(this).attr('s', '17');
                        //    }

                        //});
                        //// for Row G
                        //$('row c[r^="G"]', sheet).each(function () {
                        //    inputString = $('is t', this).text();
                        //    if (inputString.startsWith("`")) {
                        //        s = inputString.replace("`", "");
                        //        $('is t', this).text(s);
                        //        $(this).attr('s', '17');
                        //    }

                        //});
                        //// for Row H
                        //$('row c[r^="H"]', sheet).each(function () {
                        //    inputString = $('is t', this).text();
                        //    if (inputString.startsWith("`")) {
                        //        s = inputString.replace("`", "");
                        //        $('is t', this).text(s);
                        //        $(this).attr('s', '17');
                        //    }

                        //});

                    },
              },

            ],
            "columns": @Html.Raw(ViewBag.ReportColumns),
            "rowCallback": function (row, data, index) {
                if (data.HRF=="H") {
                    $('td', row).css('background-color', '#C8EAFB');
                    $('td:eq(0)', row).attr('colspan', ReportColumnsCount);
                    for (y = 1; y < ReportColumnsCount; y++) {
                        $('td:eq('+ y +')', row).css('display', 'none');
                    }
                }
                else if (data.HRF=="F")
                {
                    $('td', row).css('background-color', '#eef8fd');
                    $('td:eq(0)', row).attr('colspan', ReportFooterColumnsCount);
                    for (y = 1; y < ReportFooterColumnsCount; y++) {
                        $('td:eq(' + y + ')', row).css('display', 'none');
                    }
                }
                else if (data.HRF == "D") {
                    $('td', row).css('background-color', '#d5e6c2');
                    $('td:eq(0)', row).attr('colspan', ReportFooterColumnsCount);
                    for (y = 1; y < ReportFooterColumnsCount; y++) {
                        $('td:eq(' + y + ')', row).css('display', 'none');
                    }
                }
            }
        });
    };
    function PdfFooterFormat1(txt1) {
        //var length = 182;
        var sRet = txt1.replace('', '^');
        sRet = sRet.split('&nbsp').join('      ');

        return sRet;
    }

    function PdfHeaderFormat1(txt1) {
        var sRet = txt1.replace('', '~');
        sRet = sRet.split('&nbsp').join('      ');

        return sRet;
    }

    function PdfFooterFormat(txt1) {
        //var length = 182;
        var sRet = txt1.replace('^', '');
        sRet = sRet.split('&nbsp').join('      ');

        return sRet;
    }

    function PdfHeaderFormat(txt1) {
        var sRet = txt1.replace('~', '');
        sRet = sRet.split('&nbsp').join('      ');

        return sRet;
    }

    var day = '@fm'; //{fm : "01-02-12"};
    debugger;
    var MonthNameyear;
    dteSplit = day.split('-');
    days = dteSplit[0];
    month = dteSplit[1];
    year = dteSplit[2];
    // year = year.substring(0, 4);
    MonthNameyear = days + "-" + month + "-" + year;
    $(function () {
        //debugger;
        var dateyear = new Date(MonthNameyear)
        $('#monthyearF').datepicker();
        $('#monthyearF').datepicker('setDate', dateyear);
        $('#T14rtfrom').datepicker();
        $('#T14rtfrom').datepicker('setDate', dateyear);
    });
    $(function () {
        var dateyear1 = new Date(MonthNameyear)
        $('#monthyearT').datepicker();
        $('#monthyearT').datepicker('setDate', dateyear1);

        $('#T14rtto').datepicker();
        $('#T14rtto').datepicker('setDate', dateyear1);

    });
    $('#rtfromDate').val(MonthNameyear);
    $('#rttoDate').val(MonthNameyear);
    $('#T14rtfromDate').val(MonthNameyear);
    $('#T14rttoDate').val(MonthNameyear);
    $("#btntwoDtpickersSearch").click(function ()
    {
        var fromDate = $("#rtfromDate").val();
        var toDate = $("#rttoDate").val();

        if ($("#rttoDate").val() == "") {
            showGlobalModal('E#Save Error#Please Select Todate ');
            //$('#rttoDate').focus();
        }
        else {
            var Todate = $('#rttoDate').val();
        }
        if ($("#rtfromDate").val() == "") {
            showGlobalModal('E#Save Error#Please Select Fromdate ');
            $('#rtfromDate').focus();
        } else {
            var Fromdate = $('#rtfromDate').val();
        }
        if (Fromdate != undefined && Todate != undefined) {
            ajaxSpinnerShow();
            var mainUrl = '@dataUrl';

            var ajaxurl = mainUrl.replace('^1', fromDate);
            ajaxurl = ajaxurl.replace('^2', toDate);
            ajaxurl = ajaxurl.split('&amp;').join('&');

            reportMsgTop = '@ViewBag.twoDtpickersLabel1 : ' + fromDate + ' - ' + toDate;
            //reportMsgTop = ' @ViewBag.twoDtpickersLabel1 : ' + fromDate + ' , @ViewBag.twoDtpickersLabel2 : ' + toDate ;

            $('#rptGrid').DataTable().ajax.url(ajaxurl).load(function () {
                ajaxSpinnerHide();
            });
        }
    });

    //encash summary
    $("#btnTwoDatePickerTwoRbtnSearch").click(function () {

        var fromDate = $("#T14rtfromDate").val();
        var toDate = $("#T14rttoDate").val();
        var RegEmp = $("input[id='rdRegbEmp']:checked").val();
        var SupEmp = $("input[id='rdbSupEmp']:checked").val();
        if ($("#T14rttoDate").val() == "") {
            showGlobalModal('E#Save Error#Please Select Todate ');
            //$('#rttoDate').focus();
        }
        else {
            var Todate = $('#T14rttoDate').val();
        }
        if ($("#T14rtfromDate").val() == "") {
            showGlobalModal('E#Save Error#Please Select Fromdate ');
            $('#T14rtfromDate').focus();
        } else {
            var Fromdate = $('#T14rtfromDate').val();
        }
        if (Fromdate != undefined && Todate != undefined) {
            ajaxSpinnerShow();
            var mainUrl = '@dataUrl';

            //var fromDate = $("#rtfromDate").val();
            //    var toDate = $("#rttoDate").val();
            var ajaxurl = mainUrl.replace('^1', fromDate);
            ajaxurl = ajaxurl.replace('^2', toDate);
            ajaxurl = ajaxurl.replace('^3', RegEmp);
            ajaxurl = ajaxurl.replace('^4', SupEmp);
            ajaxurl = ajaxurl.split('&amp;').join('&');
            reportMsgTop = ' @ViewBag.twoDtpickersLabel1 : ' + fromDate + ' , @ViewBag.twoDtpickersLabel2 : ' + toDate, 'Employee Type:' + RegEmp, 'Employee Type:' + SupEmp ;

            $('#rptGrid').DataTable().ajax.url(ajaxurl).load(function () {
                ajaxSpinnerHide();
            });
        }


    });




    //pf interest calculations
    $("#btnT3AllEmpSearchOneMultiSelPFcal").click(function () {
        debugger;

        var empcode = $("#txtEmployeeSearchBox1450").val();

        var fYear = $("#fY option:selected").text();
        if (fYear == "Select") {
            showGlobalModal('E#Warning #Please Select Financial Year');
            return false;
        }

        //if (empcode == "") {
        //    empcode = $("input[id='rdbEmpAll']:checked").val();
        //}

        //if (empcode == undefined) {
        //    showGlobalModal('E#Warning #Please Enter Employee Code');
        //    return false;
        //}
        //var allemp = $("input[id='rdbEmpAll']:checked").val();

        //if (allemp == "All") {
        //    empcode = $("input[id='rdbEmpAll']:checked").val();
        //}
        //if (fYear != undefined && empcode != undefined) { //Loans != undefined &&
            fYear = fYear.substring(5, fYear.length);

            ajaxSpinnerShow();
            var mainUrl = '@dataUrl';
            var ajaxurl = mainUrl.replace('^1', empcode);

            ajaxurl = ajaxurl.replace('^2', fYear);
            ajaxurl = ajaxurl.split('&amp;').join('&');

            reportMsgTop = 'Employee : ' + empcode + ' , FY : ' + fYear;

            $('#rptGrid').DataTable().ajax.url(ajaxurl).load(function () {
                ajaxSpinnerHide();
            });
        //}
    });

    //Loan Ledger Report
    $("#btnT3AllEmpSearchOneMultiSelOneDropdown").click(function () {
        debugger;
        var LoansTypes = [];
        var prioritytype = [];
        var empcode = $("#txtEmployeeSearchBox1450").val();
        var Loans = $("#T3_LoansTypes").val();
        var priority = $("#T3_priority").val();
        $('#T3_LoansTypes :selected').each(function (i, sel) {
            LoansTypes.push($(sel).text());
        });
        if (prioritytype.length == 0)
        {
            prioritytype.push("All");
        }
        if (LoansTypes.length == 0) {
            LoansTypes.push("All");
        }
        var fYear = $("#fY option:selected").text();
        if (fYear == "Select") {
            showGlobalModal('E#Warning #Please Select Financial Year');
            return false;
        }
        if (priority == "") {
            showGlobalModal('E#Warning #Please Select priority ');
            return false;
        }
        if (Loans == "") {
            showGlobalModal('E#Warning #Please Select Loans Type');
            return false;
        }
        if (empcode == "") {
            empcode = $("input[id='rdbEmpAll']:checked").val();
        }

        if (empcode == undefined) {
            showGlobalModal('E#Warning #Please Enter Employee Code');
            return false;
        }
        var allemp = $("input[id='rdbEmpAll']:checked").val();

        if (allemp == "All") {
            empcode = $("input[id='rdbEmpAll']:checked").val();
        }
        if (fYear != undefined && empcode != undefined) { //Loans != undefined &&
            fYear = fYear.substring(5, fYear.length);

            ajaxSpinnerShow();
            var mainUrl = '@dataUrl';
            var ajaxurl = mainUrl.replace('^1', empcode);
            ajaxurl = ajaxurl.replace('^2', Loans);
            ajaxurl = ajaxurl.replace('^3', fYear);
            ajaxurl = ajaxurl.replace('^4', priority);
            ajaxurl = ajaxurl.split('&amp;').join('&');

            reportMsgTop = 'Employee : ' + empcode + ' , @ViewBag.T3MultiSelLabel : ' + LoansTypes + ' , FY : ' + fYear + ', Priority:' + priority;

            $('#rptGrid').DataTable().ajax.url(ajaxurl).load(function () {
                ajaxSpinnerHide();
            });
        }
    });

    // PF Final Settlement
    $("#btnT3AllEmpSearchOneMultiSelPF").click(function () {

        var empcode = $("#txtEmployeeSearchBox1450").val();
        var fdate=$("#monthdatePFFinal").val();

        if (fdate == "") {
            showGlobalModal('E#Warning #Please Select Date');
            return false;
        }

        if (empcode == "") {
            empcode = $("input[id='rdbEmpAll']:checked").val();
        }

        if (empcode == undefined) {
            showGlobalModal('E#Warning #Please Enter Employee Code');
            return false;
        }
        var allemp = $("input[id='rdbEmpAll']:checked").val();

        if (allemp == "All") {
            empcode = $("input[id='rdbEmpAll']:checked").val();
        }
        if (fdate != undefined && empcode != undefined) { //Loans != undefined &&


            ajaxSpinnerShow();
            var mainUrl = '@dataUrl';
            var ajaxurl = mainUrl.replace('^1', empcode);

            ajaxurl = ajaxurl.replace('^2', fdate);
            ajaxurl = ajaxurl.split('&amp;').join('&');

            reportMsgTop = 'Employee : ' + empcode + ' , FY : ' + fdate;

            $('#rptGrid').DataTable().ajax.url(ajaxurl).load(function () {
                ajaxSpinnerHide();
            });
        }
    });
    //PFnon repayable

    $("#btnT7OneMonthPickeronedropdown").click(function () {
        debugger;
        var Branchname = [];
        //var inputMonth = $("#dtOneMonthPicker").val();
        var from =$('#rtfromDate').val();
        var To = $('#rttoDate').val();
        var Branch = $("#DropdownTypes").val();
        if (Branch == null || Branch=="") {
            showGlobalModal('E#Warning #Please select Loan Type');
            return false;
        }

        if(Branch[0]=="0"){
            Branch = "ALL";
        }

        $('#DropdownTypes :selected').each(function (i, sel) {
            Branchname.push($(sel).text());
        });

        if (from != "" && To != "" && Branch != undefined) {
            ajaxSpinnerShow();
            var mainUrl = '@dataUrl';

            var ajaxurl = mainUrl.replace('^1', Branch);
            ajaxurl = ajaxurl.replace('^2', from);
            ajaxurl = ajaxurl.replace('^3', To);
            ajaxurl = ajaxurl.split('&amp;').join('&');

            reportMsgTop = ' @ViewBag.T3MultiSelLabel : ' + Branchname + ' , @ViewBag.twoDtpickersLabel1 : ' + from + ' , @ViewBag.twoDtpickersLabel1 :' + To;

            //  reportMsgTop = ' Branch: ' + branch + ' , ' + '@ViewBag.OneMonthPickerLabel1:' + inputMonth';
            $('#rptGrid').DataTable().ajax.url(ajaxurl).load(function () {
                ajaxSpinnerHide();
            });

        }
    });

    // Multirate

    $("#btnT7MultiOneMonthPickeronedropdown").click(function () {
        var Branchname = [];
        var inputMonth = $("#dtOneMonthPicker").val();
        var Branch = $("#DropdownTypes").val();
        if (Branch == null || Branch=="") {
            showGlobalModal('E#Warning #Please select Loan Type');
            return false;
        }

        if(Branch[0]=="0"){
            Branch = "ALL";
        }

        $('#DropdownTypes :selected').each(function (i, sel) {
            Branchname.push($(sel).text());
        });

        if (inputMonth != "" && Branch != undefined) {
            ajaxSpinnerShow();
            var mainUrl = '@dataUrl';

            var ajaxurl = mainUrl.replace('^1', Branch);
            ajaxurl = ajaxurl.replace('^2', inputMonth);

            ajaxurl = ajaxurl.replace('&amp;', '&');

            reportMsgTop = ' @ViewBag.T3MultiSelLabel : ' + Branchname + ' , @ViewBag.OneMonthPickerLabel1 : ' + inputMonth  ;

            //  reportMsgTop = ' Branch: ' + branch + ' , ' + '@ViewBag.OneMonthPickerLabel1:' + inputMonth';
            $('#rptGrid').DataTable().ajax.url(ajaxurl).load(function () {
                ajaxSpinnerHide();
            });

        }
    });

    //$('#DropdownTypes').on('change', function () {
    //    debugger;
    //        //alert($('#DropdownTypes').val());
    //    var totalSelected = JSON.stringify($(this).val());
    //    if (totalSelected[0] == 0 && length == 0) {
    //        alert("hi");
    //        $('#DropdownTypes option').attr('selected', true);
    //    }
    //    var arrTotal = totalSelected.split(",");
    //    var id = arrTotal[0];
    //    var res = id.substring(2, 3);
    //    if (res == "0") {
    //        $('#DropdownTypes : selected').prop('checked', true);
    //        //$('#DropdownTypes :selected').each(function (i, sel)
    //    }
    //    else {

    //    }

    //   });


    $("#btnT16OneMonthPicker").click(function () {
        //debugger;
        var Type = [];

        //var emp_code = $("#txtEmployeeSearchBox1450").val();
        //var inputMonth = $("#fYear").val();
        var inputMonth =$("#fY option:selected").text(); //added by chaitanya on 21/04/2020
        Types = $("#fYear").val();

        $('#fYear :selected').each(function (i, sel) {
            Type.push($(sel).text());
        });


        //var allemp = $("input[id='rdbEmpAll']:checked").val();

        //if (allemp == "All") {
        //    emp_code = $("input[id='rdbEmpAll']:checked").val();
        //}
        //if (emp_code == "") {
        //    showGlobalModal('E#Warning #Please Enter Employee Code');
        //    return false;
        //}
        //if (Types == null) {
        //    showGlobalModal('E#Warning #Please Select Year');
        //    return false;
        //}
        //added by chaitanya on 21/04/2020
        if (inputMonth == null || inputMonth=="Select") {
            showGlobalModal('E#Warning #Please Select Financial Period');
            return false;
        }
        //end
        //if (Type[0] == " All ") {
        //    Type = " All ";

        //}
        ajaxSpinnerShow();
        var mainUrl = '@dataUrl';

        var ajaxurl = mainUrl.replace('^1', Type);
        //ajaxurl = ajaxurl.replace('^3', inputMonth);
        //ajaxurl = ajaxurl.split('&amp;').join('&');

        reportMsgTop = '@ViewBag.OneMonthPickerLabel1 : ' + Type  ;
        // reportMsgTop = '@ViewBag.OneMonthPickerLabel1 :Branch: ' + branch + ' , '+ 'Month:' + mnth';
        $('#rptGrid').DataTable().ajax.url(ajaxurl).load(function () {
            ajaxSpinnerHide();
        });


      });


    $("#btnT7empcodeOneMonthPickeronedropdown").click(function () {

        var Type = [];

        var emp_code = $("#txtEmployeeSearchBox1450").val();
        var inputMonth = $("#dtOneMonthPicker").val();
        Types = $("#DropdownTypes").val();

        $('#DropdownTypes :selected').each(function (i, sel) {
            Type.push($(sel).text());
        });


        var allemp = $("input[id='rdbEmpAll']:checked").val();

        if (allemp == "All") {
            emp_code = $("input[id='rdbEmpAll']:checked").val();
        }
        if (emp_code == "") {
            showGlobalModal('E#Warning #Please Enter Employee Code');
            return false;
        }
        if (Types == null) {
            showGlobalModal('E#Warning #Please Select Allowances Type');
            return false;
        }
        if (Type[0] == " All ") {
            Type = " All ";

        }
        ajaxSpinnerShow();
        var mainUrl = '@dataUrl';

        var ajaxurl = mainUrl.replace('^1', emp_code);
        ajaxurl = ajaxurl.replace('^2', Type);
        ajaxurl = ajaxurl.replace('^3', inputMonth);
        ajaxurl = ajaxurl.split('&amp;').join('&');

        reportMsgTop = 'Emp code : ' + emp_code + ' , @ViewBag.T3MultiSelLabel : ' + Type + ' , @ViewBag.OneMonthPickerLabel1 : ' + inputMonth  ;
        // reportMsgTop = '@ViewBag.OneMonthPickerLabel1 :Branch: ' + branch + ' , '+ 'Month:' + mnth';
        $('#rptGrid').DataTable().ajax.url(ajaxurl).load(function () {
            ajaxSpinnerHide();
        });


    });

    //LIC Report Search function
    $("#btnT1AllEmpSearchOneMultiSelOneMonthpic").click(function () {


        //var emp_code = $("#txtEmployeeSearchBox1450").val();
        var mnth = $("#dtOneMonthPicker").val();
        var Types = $("#DDLActivites").val();
        var Finance = $("#DDLActivites").text();
        var emp_code = $("#txtEmployeeSearchBox1450").val();
        var emp_code1 = $("#txtEmployeeSearchBox1450").val();
        var allemp = $("input[id='rdbEmpAll']:checked").val();

        if (allemp == "All") {
            emp_code = $("input[id='rdbEmpAll']:checked").val();
        }
        if (emp_code == undefined || emp_code == "") {
            showGlobalModal('E#Warning #Please Enter Employee Code');
            return false;
        }


        if (emp_code != undefined && mnth != undefined ) {
            ajaxSpinnerShow();
            var mainUrl = '@dataUrl';

            var ajaxurl = mainUrl.replace('^1', emp_code);
            ajaxurl = ajaxurl.replace('^2', Types );
            ajaxurl = ajaxurl.replace('^3', mnth );
            ajaxurl = ajaxurl.split('&amp;').join('&');

            reportMsgTop = 'Emp : ' + emp_code + ' ,  Month : ' + mnth;
            $('#rptGrid').DataTable().ajax.url(ajaxurl).load(function () {
                ajaxSpinnerHide();
            });
        }

    });

    //Tsum report
    $("#btnOneMonthPickerSearchtsheet").click(function () {
        var RegEmp = $("input[id='rdRegbEmp']:checked").val();
        var SupEmp = $("input[id='rdbSupEmp']:checked").val();
        var mnpkrVal = $("#dtOneMonthPicker").val();
        if (mnpkrVal == "") {
            showGlobalModal('E#Validation#Please Select Month');
            return;
        }

        //if (SupEmp == undefined) {
        //    $("input[id='rdRegbEmp']:checked").val();

        //}

        ajaxSpinnerShow();
        var mainUrl = '@dataUrl';

        var ajaxurl = mainUrl.replace('^1', mnpkrVal);
        ajaxurl = ajaxurl.replace('^2', RegEmp);
        ajaxurl = ajaxurl.replace('^3', SupEmp);
        ajaxurl = ajaxurl.split('&amp;').join('&');
        reportMsgTop = '@ViewBag.OneMonthPickerLabel1 : ' + mnpkrVal + ', Employee Type:' + RegEmp, 'Employee Type:'+SupEmp;
        $('#rptGrid').DataTable().ajax.url(ajaxurl).load(function () {
            ajaxSpinnerHide();
        });
    });

    //General Vochers report
    $("#btnfourrbtnOneMonthPickerSearchtsheet").click(function () {
        //debugger;
        var Debitval =  $("input[id='rdbDebitval']:checked").val();
        var Creditval = $("input[id='rdbCreditval']:checked").val();
        var All = $("input[id='rdbDebitAll']:checked").val();
        var RegEmpval = $("input[id='rdRegbEmp']:checked").val();
        var SupEmpval = $("input[id='rdbSupEmp']:checked").val();

        var mnpkrVal1 = $("#dtOneMonthPicker").val();
        if (mnpkrVal1 == "") {
            showGlobalModal('E#Validation#Please Select Month');
            return;
        }
        ajaxSpinnerShow();
        var mainUrl = '@dataUrl';
        var ajaxurl = mainUrl.replace('^1', mnpkrVal1);
        ajaxurl = ajaxurl.replace('^2', RegEmpval);
        ajaxurl = ajaxurl.replace('^3', SupEmpval);
        ajaxurl = ajaxurl.replace('^4', Debitval);
        ajaxurl = ajaxurl.replace('^5', Creditval);
        ajaxurl = ajaxurl.replace('^6', All);
        ajaxurl = ajaxurl.split('&amp;').join('&');
        reportMsgTop = '@ViewBag.OneMonthPickerLabel1 : ' + mnpkrVal1 + ', Employee Type:' + RegEmpval, 'Employee Type:' + SupEmpval, 'Transaction Type:' + Debitval, 'Transaction Type:' + Creditval, 'Transaction Type:' + All;
        $('#rptGrid').DataTable().ajax.url(ajaxurl).load(function () {
            ajaxSpinnerHide();
        });
    });

    //end


    //LoanReport Search function
    $("#T8AllAndSingleEmpSearchRbtn").click(function () {
        //
        var fromDate = $("#rtfromDate1").val();
        var toDate = $("#rttoDate1").val();

        if ($("#rttoDate1").val() == "") {
            showGlobalModal('E#Save Error#Please Select Todate ');
            //$('#rttoDate').focus();
        }
        else {
            var Todate = $('#rttoDate1').val();
        }
        if ($("#rtfromDate1").val() == "") {
            showGlobalModal('E#Save Error#Please Select Fromdate ');
            $('#rtfromDate1').focus();
        } else {
            var Fromdate = $('#rtfromDate1').val();
        }
        var emp_code = $("#txtEmployeeSearchBox1450").val();
        if (emp_code == "") {
            emp_code = $("input[id='rdbEmpAll']:checked").val();
        }
        $("input[id='rdbEmpAll1empsearch']").click(function () {
            if ($("#rdbEmpAll1empsearch").is(":checked")) {
                emp_code = $("#txtEmployeeSearchBox1450").val("");
            }
        });
        if (emp_code == undefined) {
            //showGlobalModal('E#Warning #Please Enter Employee Code');
            return false;
        }

        if (emp_code != undefined && Fromdate != undefined && Todate != undefined) {
            ajaxSpinnerShow();
            var mainUrl = '@dataUrl';

            var ajaxurl = mainUrl.replace('^1', emp_code);
            ajaxurl = ajaxurl.replace('^2', fromDate);
            ajaxurl = ajaxurl.replace('^3', toDate);
            ajaxurl = ajaxurl.split('&amp;').join('&');


            // reportMsgTop = '@ViewBag.OneMonthPickerLabel1 EmpCode: ' + emp_code+' ' + fromDate + ' - ' + toDate; ;
            $('#rptGrid').DataTable().ajax.url(ajaxurl).load(function () {
                ajaxSpinnerHide();
            });
        }

    });



    // ENCH SUMARY

    function T14fromdate() {
        var fm = $("#T14rtfromDate").val();
        var fm2 = $("#T14rttoDate").val();

        var fromdate = fm.split('-');
        var dd = parseInt(fromdate[0]);
        var mm = parseInt(fromdate[1]);
        var yy = parseInt(fromdate[2]);

        var todate = fm2.split('-');
        var dd2 = parseInt(todate[0]);
        var mm2 = parseInt(todate[1]);
        var yy2 = parseInt(todate[2]);
        // checking
        if (dd > dd2 && mm == mm2 && yy == yy2) {
            showGlobalModal('E#Warning #Please Enter From date greater then To date');
            var fm2 = $("#T14rttoDate").val('');
            $('#T14rttoDate').focus();
        }
            //else if (mm > mm2 || yy > yy2) {
            //    showGlobalModal('E#Warning #Please Enter From date greater then To date');
            //    var fm2 = $("#T14rttoDate").val('');
            //    $('#T14rttoDate').focus();
            //}

        else if (mm > mm2 && yy > yy2) {
            showGlobalModal('E#Warning #Please Enter From date greater then To date');
            var fm2 = $("#T14rttoDate").val('');
            $('#T14rttoDate').focus();
        }
    }
    function dateValidation() {
        //
        var fm = $("#rtfromDate1").val();
        var fm2 = $("#rttoDate1").val();

        var fromdate = fm.split('-');
        var dd = parseInt(fromdate[0]);
        var mm = parseInt(fromdate[1]);
        var yy = parseInt(fromdate[2]);
        var todate = fm2.split('-');
        var dd2 = parseInt(todate[0]);
        var mm2 = parseInt(todate[1]);
        var yy2 = parseInt(todate[2]);
        // checking
        //if (dd > dd2 || mm > mm2 || yy > yy2 ) {
        //    showGlobalModal('E#Warning #Please Enter From date greater then To date');
        //    var fm2 = $("#rttoDate1").val('');
        //    $('#rttoDate1').focus();
        //}
        //else {

        //}
        if (dd > dd2 && mm == mm2 && yy == yy2) {
            showGlobalModal('E#Warning #Please Enter From date greater then To date');
            var fm2 = $("#rttoDate").val('');
            $('#rttoDate').focus();
        }
        else if (mm > mm2 || yy > yy2) {
            showGlobalModal('E#Warning #Please Enter From date greater then To date');
            var fm2 = $("#rttoDate").val('');
            $('#rttoDate').focus();
        }
    }

    //LIC Report Search function


    var finmonth = '@fm';
    var fmonth=finmonth.split('-');

    var finmonthyear="'"+fmonth[1] +"-"+fmonth[0]+"'";

    $('#dtOneMonthPickerYear').datepicker({
        minViewMode: 1,
        autoclose: true,
        format: 'MM-yyyy',
    }).datepicker("setDate", finmonthyear);

    </script>
    <script>
    $("#AllAndSingleEmpSearchRbtn1450").click(function () {

        var emp_code = $("#txtEmployeeSearchBox1450").val();
        var allemp = $("input[id='rdbEmpAll']:checked").val();

        if (allemp == "All") {
            emp_code = $("input[id='rdbEmpAll']:checked").val();
        }


        if (emp_code == undefined || emp_code=="") {
            showGlobalModal('E#Warning #Please Enter Employee Code');
            return false;
        }

        if (emp_code != undefined) {
            ajaxSpinnerShow();
            var mainUrl = '@dataUrl';

            var ajaxurl = mainUrl.replace('^1', emp_code);
            //ajaxurl = ajaxurl.replace('^2', Types );
            //ajaxurl = ajaxurl.replace('^3', mnth );
            //ajaxurl = ajaxurl.replace('&amp;', '&');
            ajaxurl = ajaxurl.replace('&amp;', '&');

            reportMsgTop = '@ViewBag.OneMonthPickerLabel1 empcode: ' + emp_code ;
            $('#rptGrid').DataTable().ajax.url(ajaxurl).load(function () {
                ajaxSpinnerHide();
            });
        }

    });
    //$('#dtOneMonthPickerYear').datepicker({
    //    minViewMode: 1,
    //    autoclose: true,
    //    format: 'MM-yyyy',
    //}).datepicker("setDate", "+0d");

    //$("#T3_LoansTypes").change(function () {
    //    debugger;
    //    var value = $("#T3_LoansTypes").val();

    //    if (value == "0") {
    //        $('#T3_LoansTypes').attr('disabled', false);
    //    }

    //});

    // LOAN LEDGER
    $("#btnT1AllEmpSearchTwoDropDowns").click(function () {
        debugger;
        var LoansTypes = [];
        var prioritytype = [];
        var empcode = $("#txtEmployeeSearchBox1450").val();
        var Loans = $("#T3_LoansTypes").val();
        var ptiority = $("#T3_priority").val();
        $('#T3_LoansTypes :selected').each(function (i, sel) {
            LoansTypes.push($(sel).text());
        });

        if (prioritytype.length == 0) {
            prioritytype.push("All");
        }
        if (empcode == "") {
            empcode = $("input[id='rdbEmpAll']:checked").val();
        }
        if (ptiority == null) {
            showGlobalModal('E#Warning #Please select ptiority ');
            return false;
        }

        if (Loans == null) {
            showGlobalModal('E#Warning #Please select Loan Type');
            return false;
        }
        if (Loans[0] == 0) {
            Loans = "0";
        }
        if (empcode == undefined) {
            showGlobalModal('E#Warning #Please Enter Employee Code');
            return false;
        }
        var allemp = $("input[id='rdbEmpAll']:checked").val();

        if (allemp == "All") {
            empcode = $("input[id='rdbEmpAll']:checked").val();
        }

        var BranchTypes = [];

        var Branch = $("#Branch").val();
        $('#Branch :selected').each(function (i, sel) {
            BranchTypes.push($(sel).text());
        });

        var  fYear = $("#fYear option:selected").text();
        if (fYear == "Select") {
            showGlobalModal('E#Warning #Please Select Financial Year');

        }

        //if (Branch == null) {
        //    showGlobalModal('E#Warning #Please Select Branch');
        //    return false;
        //}

        if (fYear != "Select" && Loans != null) { //Loans != undefined &&  Branch != null
            ajaxSpinnerShow();
            var mainUrl = '@dataUrl';
            var ajaxurl = mainUrl.replace('^1', fYear);
            ajaxurl = ajaxurl.replace('^2', Loans);
            ajaxurl = ajaxurl.replace('^3', empcode);
            ajaxurl = ajaxurl.replace('^4', ptiority);

            ajaxurl = ajaxurl.split('&amp;').join('&');

            reportMsgTop = 'Employee : ' + empcode + ' , @ViewBag.T3MultiSelLabels :' + LoansTypes + ' , FY : ' + fYear + ', Priority' + ptiority ;


            $('#rptGrid').DataTable().ajax.url(ajaxurl).load(function () {
                ajaxSpinnerHide();
            });
        }
    });

    //Tsum report
    $("#btnOneMonthPickerSearchtsheet").click(function () {
        //
        var RegEmp = $("input[id='rdRegbEmp']:checked").val();
        var SupEmp = $("input[id='rdbSupEmp']:checked").val();
        var mnpkrVal = $("#dtOneMonthPicker").val();
        if (mnpkrVal == "") {
            showGlobalModal('E#Validation#Please Select Month');
            return;
        }

        //if (SupEmp == undefined) {
        //    $("input[id='rdRegbEmp']:checked").val();
        //}

        ajaxSpinnerShow();
        var mainUrl = '@dataUrl';

        var ajaxurl = mainUrl.replace('^1', mnpkrVal);
        ajaxurl = ajaxurl.replace('^2', RegEmp);
        ajaxurl = ajaxurl.replace('^3', SupEmp);
        ajaxurl = ajaxurl.split('&amp;').join('&');
        reportMsgTop = '@ViewBag.OneMonthPickerLabel1 : ' + mnpkrVal + ', RegEmp:'+RegEmp, 'SupEmp:'+SupEmp;
        $('#rptGrid').DataTable().ajax.url(ajaxurl).load(function () {
            ajaxSpinnerHide();
        });
    });
    </script>

    @*Loan Shedule Report*@
    <script>
    $("#BtnSearchForLonsAndSchedulesOfEmp").click(function () {
        //debugger;
        loanids = [];
        scheduleids = [];
        $('input:checkbox').removeAttr('checked');
        var loancode = $("#txtAllEmpSearchforLoansAndSchedules1").val();
        var schedulecode = $("#txtAllEmpSearchforLoansAndSchedules2").val();
        var schedulecode1 = $("#txtAllEmpSearchforLoansAndSchedules2").text();
        console.log(schedulecode1);
        var mnth = $("#dtOneMonthPicker").val();

        if (loancode == "" && schedulecode == "") {
            showGlobalModal('I#Required #Please Select Loan/Scedule');
            return false;
        }
        if (loancode == undefined && schedulecode != undefined) {
            showGlobalModal('E#Warning #Please Enter Loan Code');
            return false;
        }

        if (schedulecode == undefined && loancode != undefined) {
            showGlobalModal('E#Warning #Please Enter Schedule Code');
            return false;
        }

        if (mnth == "") {
            showGlobalModal('E#Warning #Please Select Month');
            return false;
        }



        if ((loancode != undefined || loancode == "") && (schedulecode == undefined || schedulecode == "") && mnth != undefined ) {

            ajaxSpinnerShow();
            var mainUrl = '@dataUrl';

            var ajaxurl = mainUrl.replace('^1', loancode);
            ajaxurl = ajaxurl.replace('^3', mnth);
            //ajaxurl = ajaxurl.replace('^3', mnth );
            //ajaxurl = ajaxurl.replace('&amp;', '&');
            ajaxurl = ajaxurl.split('&amp;').join('&');

            reportMsgTop = '@ViewBag.OneMonthPickerLabel1 : ' + mnth ;
            $('#rptGrid').DataTable().ajax.url(ajaxurl).load(function () {
                ajaxSpinnerHide();
            });

        }
        else if ((schedulecode != undefined || schedulecode == "") && (loancode == undefined || loancode == "") && mnth != undefined ) {

            ajaxSpinnerShow();
            var mainUrl = '@dataUrl';

            var ajaxurl = mainUrl.replace('^2', schedulecode);
            ajaxurl = ajaxurl.replace('^3', mnth);
            //ajaxurl = ajaxurl.replace('^3', mnth );
            //ajaxurl = ajaxurl.replace('&amp;', '&');
            ajaxurl = ajaxurl.split('&amp;').join('&');

            reportMsgTop = '@ViewBag.OneMonthPickerLabel1 : ' + mnth ;
            $('#rptGrid').DataTable().ajax.url(ajaxurl).load(function () {
                ajaxSpinnerHide();
            });
        }
    });
    </script>

    <script>
        $("#BtnSearchLoansWithdate").click(function () {
            debugger;
        loanids = [];

        $('input:checkbox').removeAttr('checked');
            var empcode;
           
        var mnth = $("#dtOneMonthPicker").val();

        //if (loancode == "") {
        //    showGlobalModal('I#Required #Please Select Loan/Scedule');
        //    return false;
        //}
        //if (loancode == undefined) {
        //    showGlobalModal('E#Warning #Please Enter Loan Code');
        //    return false;
        //}

        if (mnth == "") {
            showGlobalModal('E#Warning #Please Select Month');
            return false;
        }



        if (mnth != undefined ) {
            ajaxSpinnerShow();
            var mainUrl = '@dataUrl';

            var ajaxurl = mainUrl.replace('^1', empcode);
            ajaxurl = ajaxurl.replace('^2', mnth);
            //ajaxurl = ajaxurl.replace('^3', mnth );
            //ajaxurl = ajaxurl.replace('&amp;', '&');
            ajaxurl = ajaxurl.split('&amp;').join('&');

            reportMsgTop = '@ViewBag.OneMonthPickerLabel1 : ' + mnth ;
            $('#rptGrid').DataTable().ajax.url(ajaxurl).load(function () {
                ajaxSpinnerHide();
            });

        }

    });
    </script>
    <script>
    // Allowance Report
    $("#btnT4AllEmpSearchOneMultiSelOneMonthpic").click(function () {

        var AllowanceType = [];
        var emp_code = $("#txtEmployeeSearchBox1450").val();
        var mnth = $("#dtOneMonthPicker").val();
        var AllowanceTypes = $("#AllowanceTypes").val();

        $('#AllowanceTypes :selected').each(function (i, sel) {
            AllowanceType.push($(sel).text());
        });
        if (emp_code == "") {
            emp_code = $("input[id='rdbEmpAll']:checked").val();
        }

        if (emp_code == undefined) {
            showGlobalModal('E#Warning #Please Enter Employee Code');
            return false;
        }
        var allemp = $("input[id='rdbEmpAll']:checked").val();

        if (allemp == "All") {
            emp_code = $("input[id='rdbEmpAll']:checked").val();
        }

        if (emp_code != undefined && mnth != undefined ) {
            ajaxSpinnerShow();
            var mainUrl = '@dataUrl';

            var ajaxurl = mainUrl.replace('^1', emp_code);
            ajaxurl = ajaxurl.replace('^2', AllowanceTypes );
            ajaxurl = ajaxurl.replace('^3', mnth );
            ajaxurl = ajaxurl.split('&amp;').join('&');
            if (AllowanceType.length == 0) {
                AllowanceType.push("All");
            }
            reportMsgTop = 'Employee : ' + emp_code + ' , @ViewBag.OneMonthPickerLabel1 : ' + mnth  ;
            //reportMsgTop = '@ViewBag.OneMonthPickerLabel1 : ' + AllowanceTypes + '   month :' + mnth;
            $('#rptGrid').DataTable().ajax.url(ajaxurl).load(function () {
                ajaxSpinnerHide();
            });
        }

    });
    </script>


    <script>
    //Tsheet report
    $("#btnOneMonthPickerSearchtsheet").click(function () {

        var RegEmp = $("input[id='rdRegbEmp']:checked").val();
        var SupEmp = $("input[id='rdbSupEmp']:checked").val();
        var mnpkrVal = $("#dtOneMonthPicker").val();
        if (mnpkrVal == "") {
            showGlobalModal('E#Validation#Please Select Month');
            return;
        }

        //if (SupEmp == undefined) {
        //    $("input[id='rdRegbEmp']:checked").val();

        //}

        ajaxSpinnerShow();
        var mainUrl = '@dataUrl';

        var ajaxurl = mainUrl.replace('^1', mnpkrVal);
        ajaxurl = ajaxurl.replace('^2', RegEmp);
        ajaxurl = ajaxurl.replace('^3', SupEmp);
        ajaxurl = ajaxurl.split('&amp;').join('&');

        reportMsgTop = '@ViewBag.OneMonthPickerLabel1 : ' + mnpkrVal + ', Employee Type:' + RegEmp, 'Employee Type:'+SupEmp;
        $('#rptGrid').DataTable().ajax.url(ajaxurl).load(function () {
            ajaxSpinnerHide();
        });
    });
    </script>
    <script>
    var orgData;
    var generalData;
    var ccPostData;
    var cccPostData;
    var ccdPostData;
    var otherPostData;
    var Finalprocess = false;
    var empAll = true;
    $(document).ready(function () {

        $("#txtEmployeeSearchBox1450").attr("disabled", true);
        $("#rdbEmpAll1empsearch").click(function () {
            $('[id=rdbEmpAll1empsearch]').on('change', function () {
                empAll = false;
                $("#txtEmployeeSearchBox1450").attr("disabled", false);
            })
        });
        $("#rdbEmpAll").click(function () {
            empAll = true;
            $("#txtEmployeeSearchBox1450").attr("disabled", true);
        });
    })


    $("#btnOneMonthPickerSearchtds").click(function () {

        var empId = $("#txtEmployeeSearchBox1450").val();
        var mnpkrVal = $("#dtOneMonthPicker").val();
        if (mnpkrVal == "") {
            showGlobalModal('E#Validation#Please Select Month');
            return;
        }
        if (empId == "") {
            empId = $("input[id='rdbEmpAll']:checked").val();
        }

        if (empId == undefined) {
            showGlobalModal('E#Warning #Please Enter Employee Code');
            return false;
        }
        var allemp = $("input[id='rdbEmpAll']:checked").val();

        if (allemp == "All") {
            empId = $("input[id='rdbEmpAll']:checked").val();
        }


        ajaxSpinnerShow();
        var mainUrl = '@dataUrl';


        var ajaxurl = mainUrl.replace('^1', mnpkrVal);
        ajaxurl = ajaxurl.replace('^2', empId);
        ajaxurl = ajaxurl.split('&amp;').join('&');
        reportMsgTop = '@ViewBag.OneMonthPickerLabel1 : ' + mnpkrVal + ', EmpCode:' + empId;
        $('#rptGrid').DataTable().ajax.url(ajaxurl).load(function () {
            ajaxSpinnerHide();
        });





    });

    $("#btnOneMonthPickerSearchtdsyear").click(function () {

        var empId = $("#txtEmployeeSearchBox1450").val();
        if (empId == "") {
            empId = $("input[id='rdbEmpAll']:checked").val();
        }

        if (empId == undefined) {
            showGlobalModal('E#Warning #Please Enter Employee Code');
            return false;
        }
        var allemp = $("input[id='rdbEmpAll']:checked").val();

        if (allemp == "All") {
            empId = $("input[id='rdbEmpAll']:checked").val();
        }


        ajaxSpinnerShow();
        var mainUrl = '@dataUrl';


        var ajaxurl = mainUrl.replace('^1', empId);

        reportMsgTop = 'EmpCode:' + empId;
        $('#rptGrid').DataTable().ajax.url(ajaxurl).load(function () {
            ajaxSpinnerHide();
        });





    });

    //pf contribution effective
    $("#btnOneMonthPickerSearch").click(function () {
        //
        var mnpkrVal = $("#dtOneMonthPicker").val();
        if (mnpkrVal == "") {
            showGlobalModal('E#Validation#Please Select Month');
            return;
        }

        ajaxSpinnerShow();
        var mainUrl = '@dataUrl';

        var ajaxurl = mainUrl.replace('^1', mnpkrVal);

        reportMsgTop = '@ViewBag.OneMonthPickerLabel1 : ' + mnpkrVal;
        $('#rptGrid').DataTable().ajax.url(ajaxurl).load(function () {
            ajaxSpinnerHide();
        });

    });

    // For3A
    $("#btnT3AllEmpSearchOneMultiSelPFcalForm3").click(function () {
        //

        var empcode = $("#txtEmployeeSearchBox1450").val();

        var fYear = $("#fY option:selected").text();
        if (fYear == "Select") {
            showGlobalModal('E#Warning #Please Select Financial Year');
            return false;
        }

        if (empcode == "") {
            empcode = $("input[id='rdbEmpAll']:checked").val();
        }

        if (empcode == undefined) {
            showGlobalModal('E#Warning #Please Enter Employee Code');
            return false;
        }
        var allemp = $("input[id='rdbEmpAll']:checked").val();

        if (allemp == "All") {
            empcode = $("input[id='rdbEmpAll']:checked").val();
        }
        if (fYear != undefined && empcode != undefined) {
            fYear = fYear.substring(5, fYear.length);

            ajaxSpinnerShow();
            var mainUrl = '@dataUrl';
            var ajaxurl = mainUrl.replace('^1', empcode);

            ajaxurl = ajaxurl.replace('^2', fYear);
            ajaxurl = ajaxurl.split('&amp;').join('&');

            reportMsgTop = 'Employee : ' + empcode + ' , Financial Year : ' + fYear;

            $('#rptGrid').DataTable().ajax.url(ajaxurl).load(function () {
                ajaxSpinnerHide();
            });
        }

    });










    /// All Dedcutions

    $("#btnT10DeducOneMonthPickerFourRadioButtons").click(function () {
        var empType = $("input[name='emp']:checked").val();
        var rptType = $("input[name='report']:checked").val();
        var month = $("#dtOneMonthPicker").val();

        if (month == "") {
            showGlobalModal('E#Validation#Please Select Month');
            return;
        }
        if (empType == null) {
            showGlobalModal('E#Validation# Please Select Employee Type');
            return;
        }
        if (rptType == null) {
            showGlobalModal('E#Validation# Please Select Employee Report Type');
            return
        }

        ajaxSpinnerShow();
        var mainUrl = '@dataUrl';

        var ajaxurl = mainUrl.replace('^1', empType);
        ajaxurl = ajaxurl.replace('^2', rptType);
        ajaxurl = ajaxurl.replace('^3', month);
        ajaxurl = ajaxurl.split('&amp;').join('&');
        reportMsgTop =   '@ViewBag.OneMonthPickerLabel1 : '   + month + ',     Report Type:'  + rptType;
        $('#rptGrid').DataTable().ajax.url(ajaxurl).load(function () {
            ajaxSpinnerHide();
        });
    });


    // salary bill of branch




    $("#btnT7SalbrOneMonthPickeronedropdown").click(function () {

        // $('thead').css('display', 'none');
        var inputMonth = $("#dtOneMonthPicker").val();
        var Branch = $("#txtAllEmpSearchforBranchs").val();
        if (Branch == "") {
            showGlobalModal('E#Validation#Please Select Branch');
            return;
        }

        ajaxSpinnerShow();
        var mainUrl = '@dataUrl';

        var ajaxurl = mainUrl.replace('^1', Branch);
        ajaxurl = ajaxurl.replace('^2', inputMonth );


        ajaxurl = ajaxurl.replace('&amp;', '&');

        reportMsgTop = '@ViewBag.OneMonthPickerLabel1' + inputMonth ;
        $('#rptGrid').DataTable().ajax.url(ajaxurl).load(function () {
            ajaxSpinnerHide();
        });



    });

    //LIC Report Search function
    $("#btnTLICAllEmpSearchOneMultiSelOneMonthpic").click(function () {

        // $('thead').css('display', 'none');
        //var emp_code = $("#txtEmployeeSearchBox1450").val();
        var mnth = $("#dtOneMonthPicker").val();
        var Types = $("#DDLActivites").val();
        var Finance = $("#DDLActivites").text();
        var emp_code = $("#txtEmployeeSearchBox1450").val();
        var emp_code1 = $("#txtEmployeeSearchBox1450").val();
        var allemp = $("input[id='rdbEmpAll']:checked").val();

        if (allemp == "All") {
            emp_code = $("input[id='rdbEmpAll']:checked").val();
        }
        if (emp_code == undefined || emp_code == "") {
            showGlobalModal('E#Warning #Please Enter Employee Code');
            return false;
        }


        if (emp_code != undefined && mnth != undefined ) {
            ajaxSpinnerShow();
            var mainUrl = '@dataUrl';

            var ajaxurl = mainUrl.replace('^1', emp_code);
            ajaxurl = ajaxurl.replace('^2', Types );
            ajaxurl = ajaxurl.replace('^3', mnth );
            ajaxurl = ajaxurl.split('&amp;').join('&');

            reportMsgTop = 'Emp : ' + emp_code + ' ,  Month : ' + mnth;
            $('#rptGrid').DataTable().ajax.url(ajaxurl).load(function () {
                ajaxSpinnerHide();
            });
        }

    });



    //validation for From date greater then To date
    function rdtDateValidationfrom() {
        //debugger;
        var fm = $("#rtfromDate").val();
        var fm2 = $("#rttoDate").val();
        var StartDate = document.getElementById('rtfromDate').value;
        var EndDate = document.getElementById('rttoDate').value;
        var eDate = moment(EndDate, "DD.MM.YYYY");
        var sDate = moment(StartDate, "DD.MM.YYYY");
        if (sDate > eDate) {
            showGlobalModal('E#Warning #Please ensure that To Date is greater than or equal to From Date.');
            document.getElementById('rtfromDate').value = '';
            document.getElementById("rtfromDate").focus();
            return false;
        }
    }

    function rdtDateValidationto() {
        // debugger;
        var fm = $("#rtfromDate").val();
        var fm2 = $("#rttoDate").val();

        var StartDate = document.getElementById('rtfromDate').value;
        var EndDate = document.getElementById('rttoDate').value;
        var eDate = moment(EndDate, "DD.MM.YYYY");
        var sDate = moment(StartDate, "DD.MM.YYYY");
        if (sDate > eDate) {
            showGlobalModal('E#Warning #Please ensure that To Date is greater than or equal to From Date.');
            document.getElementById('rttoDate').value = '';
            document.getElementById("rttoDate").focus();
            return false;
        }


        var from = moment(EndDate, "01.04.YYYY");

    }

    //function rdtDateValidationfrom1() {
    //    //debugger;
    //    var fm = $("#rtfromDate").val();
    //    var fm2 = $("#rttoDate").val();
    //    var StartDate = document.getElementById('rtfromDate').value;
    //    var EndDate = document.getElementById('rttoDate').value;
    //    var eDate = moment(EndDate, "DD.MM.YYYY");
    //    var sDate = moment(StartDate, "DD.MM.YYYY");
    //    if (sDate > eDate) {
    //        showGlobalModal('E#Warning #Please ensure that To Date is greater than or equal to From Date.');
    //        document.getElementById('rtfromDate').value = '';
    //        document.getElementById("rtfromDate").focus();
    //        return false;
    //    }
    //}

    //function rdtDateValidationto1() {
    //     debugger;
    //    var fm = $("#rtfromDate").val();
    //    var fm2 = $("#rttoDate").val();

    //    var StartDate = document.getElementById('rtfromDate').value;
    //    var EndDate = document.getElementById('rttoDate').value;
    //    //var eDate = moment(EndDate, "DD.MM.YYYY");
    //    //var sDate = moment(StartDate, "DD.MM.YYYY");
    //    //if (sDate > eDate) {
    //    //    showGlobalModal('E#Warning #Please ensure that To Date is greater than or equal to From Date.');
    //    //    document.getElementById('rttoDate').value = '';
    //    //    document.getElementById("rttoDate").focus();
    //    //    return false;
    //    //}


    //    var from = moment(EndDate, "01.04.YYYY");
    //    var to = moment(StartDate, "31.03.YYYY");
    //    if (from > to) {
    //        showGlobalModal('E#Warning #Please ensure that To Date is greater than or equal to From Date.');
    //        document.getElementById('rttoDate').value = '';
    //        document.getElementById("rttoDate").focus();
    //        return false;
    //    }

    //}




    // Yearly Pay Report btnGT2AllEmpSearchOneDropdown
    $("#btnGT2AllEmpSearchOneDropdown").click(function () {
        var empcode = $("#txtEmployeeSearchBox1450").val();
        var fYear = $("#fY option:selected").text();
        if (fYear == "Select") {
            showGlobalModal('E#Warning #Please Select Financial Year');
            return false;
        }

        if (empcode == "") {
            empcode = $("input[id='rdbEmpAll']:checked").val();
        }

        if (empcode == undefined) {
            showGlobalModal('E#Warning #Please Enter Employee Code');
            return false;
        }
        var allemp = $("input[id='rdbEmpAll']:checked").val();

        if (allemp == "All") {
            empcode = $("input[id='rdbEmpAll']:checked").val();
        }
        if (fYear != undefined && empcode != undefined) { //Loans != undefined &&
            fYear = fYear.substring(5, fYear.length);

            ajaxSpinnerShow();
            var mainUrl = '@dataUrl';
            var ajaxurl = mainUrl.replace('^1', empcode);
            ajaxurl = ajaxurl.replace('^2', fYear);
            ajaxurl = ajaxurl.split('&amp;').join('&');

            reportMsgTop = 'Employee : ' + empcode +  '  FY : ' + fYear;

            $('#rptGrid').DataTable().ajax.url(ajaxurl).load(function () {
                ajaxSpinnerHide();
            });
        }
    });

    </script>

    <script>
        document.getElementById("reports").className = "active"
    </script>
    <script>
        $('#monthdatePFFinal').datepicker({
            format: 'dd-mm-yyyy',
            todayHighlight: true,
            autoclose: true
        });

    </script>
